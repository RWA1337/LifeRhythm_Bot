import os
import threading
import random
import math
from datetime import datetime, date
from typing import Dict, Any, List

from flask import Flask
from telegram import Update
from telegram.ext import Application, CommandHandler, ContextTypes

# ======== –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è ========
BOT_TOKEN = os.getenv("BOT_TOKEN")
if not BOT_TOKEN or not BOT_TOKEN.strip():
    raise RuntimeError("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è BOT_TOKEN –Ω–µ –∑–∞–¥–∞–Ω–∞. –£–∫–∞–∂–∏ –µ—ë –≤ Render ‚Üí Environment.")

# ======== –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–∞–º—è—Ç—å) ========
USERS: Dict[int, Dict[str, Any]] = {}

def u(user_id: int) -> Dict[str, Any]:
    """–õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è."""
    if user_id not in USERS:
        USERS[user_id] = {
            "name": None,
            "sex": None,         # '–º' –∏–ª–∏ '–∂'
            "height": None,      # —Å–º
            "weight": None,      # –∫–≥
            "dob": None,         # YYYY-MM-DD
            "goal": None,        # —Ü–µ–ª—å: –ø–æ—Ö—É–¥–µ–Ω–∏–µ/–∑–¥–æ—Ä–æ–≤—å–µ/...
            "water_total": 0,    # –º–ª –∑–∞ —Å–µ–≥–æ–¥–Ω—è
            "water_day": date.today().isoformat(),
        }
    # —Å–±—Ä–æ—Å –≤–æ–¥—ã –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–Ω—è
    if USERS[user_id]["water_day"] != date.today().isoformat():
        USERS[user_id]["water_day"] = date.today().isoformat()
        USERS[user_id]["water_total"] = 0
    return USERS[user_id]

# ======== –£—Ç–∏–ª–∏—Ç—ã ========
TG_LIMIT = 4096
def chunk_text(s: str, limit: int = TG_LIMIT) -> List[str]:
    parts = []
    while len(s) > limit:
        cut = s.rfind("\n", 0, limit)
        if cut == -1:
            cut = limit
        parts.append(s[:cut])
        s = s[cut:]
    if s:
        parts.append(s)
    return parts

async def send_long(update: Update, text: str):
    for part in chunk_text(text):
        await update.message.reply_text(part)

def parse_kv(args: List[str]) -> Dict[str, str]:
    out = {}
    for token in args:
        if "=" in token:
            k, v = token.split("=", 1)
            out[k.strip().lower()] = v.strip()
    return out

def pick_many(pool: List[str], count: int) -> List[str]:
    count = max(1, min(count, len(pool)))
    return random.sample(pool, count)

# ======== –î–ê–ù–ù–´–ï (—Å–∂–∞—Ç—ã–µ, –Ω–æ –¥–∞—é—Ç —Å–æ—Ç–Ω–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π) ========

EXERCISE_BLOCKS = {
    "–∑–∞—Ä—è–¥–∫–∞": [
        "–ü—Ä—ã–∂–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ 30 —Å–µ–∫",
        "–ö—Ä—É–≥–æ–≤—ã–µ –º–∞—Ö–∏ —Ä—É–∫–∞–º–∏ 20 —Å–µ–∫",
        "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è 15 —Ä–∞–∑",
        "–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å—Ç–µ–Ω—ã 12 —Ä–∞–∑",
        "–ü–ª–∞–Ω–∫–∞ 30 —Å–µ–∫",
        "–í—ã–ø–∞–¥—ã –Ω–∞ –º–µ—Å—Ç–µ 10/10",
        "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è –ª—ë–∂–∞ 15 —Ä–∞–∑",
        "–ë–µ—Ä–ø–∏ –±–µ–∑ –ø—Ä—ã–∂–∫–∞ 8 —Ä–∞–∑",
        "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç 15 —Ä–∞–∑",
        "–ü–æ–¥—ä—ë–º –∫–æ–ª–µ–Ω –∫ –≥—Ä—É–¥–∏ —Å—Ç–æ—è 20 —Å–µ–∫",
        "–ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞ 20/20 —Å–µ–∫",
        "–†–∞—Å—Ç—è–∂–∫–∞ —à–µ–π–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–∞ 30 —Å–µ–∫",
        "–ö–æ—à–∫–∞-–∫–æ—Ä–æ–≤–∞ 8 —Ü–∏–∫–ª–æ–≤",
        "–ù–∞–∫–ª–æ–Ω—ã –∫–æ—Ä–ø—É—Å–∞ 12 —Ä–∞–∑",
        "–ü—Ä—É–∂–∏–Ω–∏—Å—Ç—ã–µ –≤—ã–ø–∞–¥—ã 8/8",
        "–ü—Ä—ã–∂–∫–∏ ¬´–∑–≤–µ–∑–¥–∞¬ª 20 —Å–µ–∫",
        "–°—É–ø–µ—Ä–º–µ–Ω 12 —Ä–∞–∑",
        "–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 12/12",
        "–ü–æ–¥—ä—ë–º –Ω–∞ –Ω–æ—Å–∫–∏ 20 —Ä–∞–∑",
        "–†–∞—Å—Ç—è–∂–∫–∞ –∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å–∞ 20/20 —Å–µ–∫",
    ],
    "–ø–æ—Ö—É–¥–µ–Ω–∏–µ": [
        "–ë–µ—Ä–ø–∏ 10 —Ä–∞–∑",
        "–ü—Ä—ã–∂–∫–∏ —Å —Ä–∞–∑–≤–µ–¥–µ–Ω–∏–µ–º —Ä—É–∫ 30 —Å–µ–∫",
        "–°–∫–µ–π—Ç-–ø–µ—Ä–µ–º–∞—Ö–∏ 30 —Å–µ–∫",
        "–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –±–µ–≥ (–≥–æ—Ä–∫–∞) 30 —Å–µ–∫",
        "–ü—Ä–∏—Å–µ–¥ + –ø—Ä—ã–∂–æ–∫ 12 —Ä–∞–∑",
        "–ê–ª—å–ø–∏–Ω–∏—Å—Ç 30 —Å–µ–∫",
        "–†—É—Å—Å–∫–∏–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 20 —Ä–∞–∑",
        "–ñ–∏–º –æ—Ç –ø–æ–ª–∞ –Ω–∞ –∫–æ–ª–µ–Ω—è—Ö 12 —Ä–∞–∑",
        "–í—ã–ø–∞–¥—ã –Ω–∞–∑–∞–¥ 12/12",
        "–ü–ª–∞–Ω–∫–∞ + –∫–∞—Å–∞–Ω–∏–µ –ø–ª–µ—á 20 —Ä–∞–∑",
        "–°—É–º–æ-–ø—Ä–∏—Å–µ–¥ 15 —Ä–∞–∑",
        "–î–∂–∞–º–ø–∏–Ω–≥-–¥–∂–µ–∫ 30 —Å–µ–∫",
        "–°–∫–∞–∫–∞–ª–∫–∞ (–±–µ–∑ —Å–∫–∞–∫–∞–ª–∫–∏) 45 —Å–µ–∫",
        "–°–∞–π–¥-—à–∞–≥–∏ —Å –ø—Ä–∏—Å–µ–¥–æ–º 30 —Å–µ–∫",
        "–ë–æ–∫–æ–≤—ã–µ –≤—ã–ø–∞–¥—ã 12/12",
        "–°—É–ø–µ—Ä–º–µ–Ω —É–¥–µ—Ä–∂–∞–Ω–∏–µ 30 —Å–µ–∫",
        "–ö–æ—Å—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 15/15",
        "–ú—ë—Ä—Ç–≤—ã–π –∂—É–∫ 20 —Ä–∞–∑",
        "–ü–ª–∞–Ω–∫–∞ 45 —Å–µ–∫",
        "–ü—Ä—ã–∂–∫–∏ –≤–ø–µ—Ä—ë–¥-–Ω–∞–∑–∞–¥ 30 —Å–µ–∫",
    ],
    "–≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å": [
        "–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –±–µ–≥ –Ω–∞ –º–µ—Å—Ç–µ 40/20 —Å–µ–∫ √ó 4",
        "–°–∞–π–¥-—à–∞–≥–∏ –±—ã—Å—Ç—Ä—ã–µ 45 —Å–µ–∫",
        "–ê–ª—å–ø–∏–Ω–∏—Å—Ç 40 —Å–µ–∫",
        "–°–∫–µ–π—Ç-–ø–µ—Ä–µ–º–∞—Ö–∏ 40 —Å–µ–∫",
        "–ë–µ—Ä–ø–∏ 8‚Äì12 —Ä–∞–∑",
        "–í—ã—Å–æ–∫–∏–µ –∫–æ–ª–µ–Ω–∏ 40 —Å–µ–∫",
        "–ü–ª–∞–Ω–∫–∞ 60 —Å–µ–∫",
        "–î–∂–∞–º–ø–∏–Ω–≥-–¥–∂–µ–∫ 45 —Å–µ–∫",
        "–ë—ë—Ä–¥-–¥–æ–≥ 20/20",
        "–ü–æ–¥—ä—ë–º –∫–æ–ª–µ–Ω —Å–∏–¥—è 30 —Ä–∞–∑",
        "–õ—è–≥—É—à–∫–∞ 15 —Ä–∞–∑",
        "–ü—Ä—ã–∂–∫–∏ –≤ –≤—ã–ø–∞–¥—ã 10/10",
        "–ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã (–æ–ø–æ—Ä–∞) 12/12",
        "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è 20 —Ä–∞–∑",
        "–û—Ç–∂–∏–º–∞–Ω–∏—è 10‚Äì15",
        "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 25",
        "–°—É–º–æ-–ø—É–ª—å—Å 20 —Ä–∞–∑",
        "–ë–µ–≥ –Ω–∞ –º–µ—Å—Ç–µ 2 –º–∏–Ω",
        "–ü—Ä—ã–∂–∫–∏ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ 20/20",
        "–ü–ª–∞–Ω–∫–∞ —Å —à–∞–≥–∞–º–∏ 40 —Å–µ–∫",
    ],
    "—Å–ø–∏–Ω–∞": [
        "–°—É–ø–µ—Ä–º–µ–Ω 15 —Ä–∞–∑",
        "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç 15‚Äì20",
        "–ë—ë—Ä–¥-–¥–æ–≥ 12/12",
        "–¢—è–≥–∞ –ø–æ–ª–æ—Ç–µ–Ω—Ü–∞ (–∏–∑–æ–º–µ—Ç—Ä–∏–∫–∞) 30 —Å–µ–∫",
        "–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –ª—ë–∂–∞ 15",
        "–ü–ª–∞–Ω–∫–∞ –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å—è—Ö 30‚Äì45 —Å–µ–∫",
        "–ö–æ–±—Ä–∞ 20‚Äì30 —Å–µ–∫",
        "–õ–æ–¥–æ—á–∫–∞ 20‚Äì30 —Å–µ–∫",
        "–†–∞—Å—Ç—è–∂–∫–∞ –∫–æ—à–∫–∞-–∫–æ—Ä–æ–≤–∞ 10 —Ü–∏–∫–ª–æ–≤",
        "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏–µ –ª–æ–ø–∞—Ç–æ–∫ –ª—ë–∂–∞ 12",
        "–í–µ—Ä—Ö–Ω—è—è –ø–ª–∞–Ω–∫–∞ 30 —Å–µ–∫",
        "–û—Ç–≤–µ–¥–µ–Ω–∏–µ –Ω–æ–≥ –≤ —É–ø–æ—Ä–µ 12/12",
        "–†–∞–∑–≤–æ—Ä–æ—Ç—ã –∫–æ—Ä–ø—É—Å–∞ 12/12",
        "–ú–∞—Ö–∏ –Ω–∞–∑–∞–¥ —Å—Ç–æ—è 15/15",
        "–ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞ 20/20",
    ],
    "–æ—Ñ–∏—Å": [
        "–ö—Ä—É–≥–∏ –ø–ª–µ—á–∞–º–∏ 10/10",
        "–†–∞—Å—Ç—è–∂–∫–∞ —Ç—Ä–∞–ø–µ—Ü–∏–π 20/20 —Å–µ–∫",
        "–ù–∞–∫–ª–æ–Ω—ã –≥–æ–ª–æ–≤—ã 5 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π",
        "–°–∂–∞—Ç–∏–µ –ª–æ–ø–∞—Ç–æ–∫ 12 —Ä–∞–∑",
        "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏–µ —Å–∏–¥—è 20/20 —Å–µ–∫",
        "–ü–æ–¥—ä—ë–º –∫–æ–ª–µ–Ω –∫ –≥—Ä—É–¥–∏ —Å–∏–¥—è 12/12",
        "–í—Å—Ç–∞—Ç—å/—Å–µ—Å—Ç—å 15 —Ä–∞–∑",
        "–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å—Ç–æ–ª–∞ 12",
        "–ö–∏—Å—Ç–µ–≤–æ–π ¬´–Ω–∞–º–æ—Ç¬ª 12/12",
        "–†–∞—Å—Ç—è–∂–∫–∞ —Å–≥–∏–±–∞—Ç–µ–ª–µ–π –±–µ–¥—Ä–∞ 20/20 —Å–µ–∫",
        "–°—Ç–æ—è –Ω–∞ –Ω–æ—Å–∫–∞—Ö 20",
        "–ë–∞–ª–∞–Ω—Å –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ 20/20 —Å–µ–∫",
        "–ü–ª–∞–Ω–∫–∞ —É —Å—Ç–æ–ª–∞ 30 —Å–µ–∫",
        "–õ–æ–ø–∞—Ç–æ—á–Ω–∞—è —Ç—è–≥–∞ –∫ —Å—Ç–æ–ª—É (–∏–∑–æ) 30 —Å–µ–∫",
        "–ú–æ–±–∏–ª–∏–∑–∞—Ü–∏—è –≥—Ä—É–¥–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–∞ 10",
    ]
}

YOGA_POSES = [
    "–¢–∞–¥–∞—Å–∞–Ω–∞ (–ì–æ—Ä–∞) ‚Äî –≤—ã–ø—Ä—è–º–∏—Å—å, –º–∞–∫—É—à–∫–∞ –≤–≤–µ—Ä—Ö",
    "–í—Ä–∏–∫—à–∞—Å–∞–Ω–∞ (–î–µ—Ä–µ–≤–æ) ‚Äî –±–∞–ª–∞–Ω—Å –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ",
    "–ê–¥–æ –ú—É–∫—Ö–∞ –®–≤–∞–Ω–∞—Å–∞–Ω–∞ (–ü—ë—Å –º–æ—Ä–¥–æ–π –≤–Ω–∏–∑) ‚Äî –≤—ã—Ç—è–∂–µ–Ω–∏–µ —Å–ø–∏–Ω—ã",
    "–ë–∞–ª–∞—Å–∞–Ω–∞ (–ü–æ–∑–∞ —Ä–µ–±—ë–Ω–∫–∞) ‚Äî —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ",
    "–ë—Ö—É–¥–∂–∞–Ω–≥–∞—Å–∞–Ω–∞ (–ö–æ–±—Ä–∞) ‚Äî –º—è–≥–∫–∏–π –ø—Ä–æ–≥–∏–±",
    "–£—Ç—Ç–∞–Ω–∞—Å–∞–Ω–∞ ‚Äî –Ω–∞–∫–ª–æ–Ω –≤–ø–µ—Ä—ë–¥ —Å—Ç–æ—è",
    "–í–∏—Ä–∞–±—Ö–∞–¥—Ä–∞—Å–∞–Ω–∞ I ‚Äî –≤—ã–ø–∞–¥, —Ä—É–∫–∏ –≤–≤–µ—Ä—Ö",
    "–í–∏—Ä–∞–±—Ö–∞–¥—Ä–∞—Å–∞–Ω–∞ II ‚Äî –≤—ã–ø–∞–¥, —Ä—É–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã",
    "–¢—Ä–∏–∫–æ–Ω–∞—Å–∞–Ω–∞ ‚Äî —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫, –≤—ã—Ç—è–∂–µ–Ω–∏–µ –±–æ–∫–æ–≤",
    "–ü–∞–≤–∞–Ω–º—É–∫—Ç–∞—Å–∞–Ω–∞ ‚Äî –∫–æ–ª–µ–Ω–∏ –∫ –≥—Ä—É–¥–∏ –ª—ë–∂–∞",
    "–°–µ—Ç—É –ë–∞–Ω–¥—Ö–∞—Å–∞–Ω–∞ ‚Äî –ø–æ–ª—É–º–æ—Å—Ç",
    "–î–∂–∞—Ç—Ö–∞—Ä–∞ –ü–∞—Ä–∏–≤–∞—Ä—Ç–∞–Ω–∞—Å–∞–Ω–∞ ‚Äî —Å–∫—Ä—É—Ç–∫–∞ –ª—ë–∂–∞",
    "–ú–∞—Ä–¥–∂–∞—Ä–∏–∞—Å–∞–Ω–∞ ‚Äî –∫–æ—à–∫–∞-–∫–æ—Ä–æ–≤–∞ (–º—è–≥–∫–æ)",
    "–ü–∞—Ä—à–≤–æ—Ç—Ç–∞–Ω–∞—Å–∞–Ω–∞ ‚Äî –Ω–∞–∫–ª–æ–Ω –∫ –ø—Ä—è–º–æ–π –Ω–æ–≥–µ",
    "–°—É–ø—Ç–∞ –ë–∞–¥–¥—Ö–∞ –ö–æ–Ω–∞—Å–∞–Ω–∞ ‚Äî –ª—ë–∂–∞, —Å—Ç–æ–ø—ã –≤–º–µ—Å—Ç–µ",
    "–ê–ø–∞–Ω–∞c–∞–Ω–∞ ‚Äî –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏–µ –∫–æ–ª–µ–Ω–µ–π –ø–æ –æ–¥–Ω–æ–º—É",
    "–ú–∞–ª–∞—Å–∞–Ω–∞ ‚Äî –≥–ª—É–±–æ–∫–∏–π –ø—Ä–∏—Å–µ–¥-—Ä–∞—Å—Ç—è–∂–∫–∞",
    "–ê—Ä–¥–∞ –ú–∞—Ç—Å–∏–µ–Ω–¥—Ä–∞—Å–∞–Ω–∞ ‚Äî —Å–∫—Ä—É—Ç–∫–∞ —Å–∏–¥—è",
    "–ü—Ä–∞—Å–∞—Ä–∏—Ç–∞ –ü–∞–¥–æ—Ç—Ç–∞–Ω–∞—Å–∞–Ω–∞ ‚Äî –Ω–∞–∫–ª–æ–Ω, –Ω–æ–≥–∏ —à–∏—Ä–æ–∫–æ",
    "–ì–æ–º—É–∫—Ö–∞—Å–∞–Ω–∞ —Ä—É–∫–∏ ‚Äî –ø–ª–µ—á–µ–≤–æ–π –ø–æ—è—Å",
    "–°—Ñ–∏–Ω–∫—Å ‚Äî –º—è–≥–∫–∏–π –ø—Ä–æ–≥–∏–± –ª—ë–∂–∞",
    "–ê—Ä–¥—Ö–∞ –•–∞–Ω—É–º–∞–Ω–∞—Å–∞–Ω–∞ ‚Äî –ø–æ–ª—É—à–ø–∞–≥–∞—Ç",
    "–ê—Ä–¥—Ö–∞ –ß–∞–Ω–¥—Ä–∞—Å–∞–Ω–∞ ‚Äî –ø–æ–ª—É–º–µ—Å—è—Ü (—Å–æ —Å—Ç–µ–Ω–æ–π)",
    "–í–∏–ø–∞—Ä–∏—Ç–∞ –ö–∞—Ä–∞–Ω–∏ ‚Äî –Ω–æ–≥–∏ –Ω–∞ —Å—Ç–µ–Ω—É",
    "–°—É–ø—Ç–∞ –ú–∞—Ü–π–µ–Ω–¥—Ä–∞—Å–∞–Ω–∞ ‚Äî —Å–∫—Ä—É—Ç–∫–∞ –ª—ë–∂–∞",
    "–ê–Ω–∞–Ω–¥ –ë–∞–ª–∞—Å–∞–Ω–∞ ‚Äî —Å—á–∞—Å—Ç–ª–∏–≤—ã–∏ÃÜ —Ä–µ–±—ë–Ω–æ–∫",
    "–ü–∞—à—á–∏–º–æ—Ç—Ç–∞–Ω–∞—Å–∞–Ω–∞ ‚Äî –Ω–∞–∫–ª–æ–Ω —Å–∏–¥—è",
    "–î–∞–Ω–¥–∞—Å–∞–Ω–∞ ‚Äî –ø–æ—Å–æ—Ö (–æ—Å–∞–Ω–∫–∞)",
    "–£—Ä–¥—Ö–≤–∞ –•–∞—Å—Ç–∞—Å–∞–Ω–∞ ‚Äî –≤—ã—Ç—è–∂–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö",
    "–®–∞–≤–∞—Å–∞–Ω–∞ ‚Äî —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ 3‚Äì5 –º–∏–Ω",
]

BREATH_MEDIT = {
    "–¥—ã—Ö–∞–Ω–∏–µ": [
        "–ö–æ—ç—Ä–µ–Ω—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ 5-5 (–≤–¥–æ—Ö 5—Å / –≤—ã–¥–æ—Ö 5—Å) 5‚Äì10 –º–∏–Ω",
        "Box 4-4-4-4 (–≤–¥–æ—Ö-–∑–∞–¥–µ—Ä–∂–∫–∞-–≤—ã–¥–æ—Ö-–∑–∞–¥–µ—Ä–∂–∫–∞) –ø–æ 4—Å, 3‚Äì5 –º–∏–Ω",
        "4-7-8 (–≤–¥–æ—Ö 4—Å / –∑–∞–¥–µ—Ä–∂–∫–∞ 7—Å / –≤—ã–¥–æ—Ö 8—Å) 2‚Äì4 –º–∏–Ω",
        "–î–∏–∞—Ñ—Ä–∞–≥–º–∞–ª—å–Ω–æ–µ (–∂–∏–≤–æ—Ç–æ–º) 6‚Äì10 –º–∏–Ω",
        "–£–¥–∂–∞–∏ –º—è–≥–∫–æ–µ 3‚Äì7 –º–∏–Ω",
        "–ù–∞–¥–∏ –®–æ–¥—Ö–∞–Ω–∞ (–ø–æ–æ—á–µ—Ä—ë–¥–Ω—ã–µ –Ω–æ–∑–¥—Ä–∏) 3‚Äì6 –º–∏–Ω",
        "–î—ã—Ö–∞–Ω–∏–µ –ø–æ —Å—á—ë—Ç—É 1‚Üí10 (—Ü–∏–∫–ª) 5 –º–∏–Ω",
        "–£–¥–ª–∏–Ω—ë–Ω–Ω—ã–π –≤—ã–¥–æ—Ö 4/6 ‚Üí 4/8, 5‚Äì7 –º–∏–Ω",
        "–†–µ–∑–æ–Ω–∞–Ω—Å–Ω–æ–µ 6 –¥—ã—Ö–∞–Ω–∏–π/–º–∏–Ω 5 –º–∏–Ω",
        "–ü–µ–π—Å–∏–Ω–≥ —Å —à–∞–≥–∞–º–∏ (–≤–¥–æ—Ö 3 —à–∞–≥–∞/–≤—ã–¥–æ—Ö 4 —à–∞–≥–∞) 5‚Äì10 –º–∏–Ω",
        "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—ã—Ö–∞–Ω–∏—è (mindful) 5 –º–∏–Ω",
        "¬´–°–æ–ª–æ–º–∏–Ω–∫–∞¬ª ‚Äî —É–∑–∫–∏–π –≤—ã–¥–æ—Ö, 3‚Äì5 –º–∏–Ω",
        "–ß–µ—Ä–µ–∑ –Ω–æ—Å-—Ä–æ—Ç (–æ—á–∏—â–∞—é—â–µ–µ) 3‚Äì5 –º–∏–Ω",
        "1:2 (–≤–¥–æ—Ö:–≤—ã–¥–æ—Ö) 4‚Üí8, 5 –º–∏–Ω",
        "–° –∫–≤–∞–¥—Ä–∞—Ç–æ–º 5-5-5-5, 5‚Äì10 –º–∏–Ω",
        "–° —É–¥–µ—Ä–∂–∞–Ω–∏–µ–º –Ω–∏–∑–∞ –∂–∏–≤–æ—Ç–∞ 3‚Äì5 –º–∏–Ω",
        "–° –º—è–≥–∫–æ–π –∫–∞–ø—Ö–∞–ª–∞–±—Ö–∞—Ç–∏ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ) 1‚Äì2 –º–∏–Ω",
        "–î—ã—Ö–∞–Ω–∏–µ —Å –º–µ—Ç—Ä–∏–∫–æ–π 3-3-6, 4‚Äì5 –º–∏–Ω",
        "–î—ã—Ö–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ —Å–Ω–æ–º 4-6, 5 –º–∏–Ω",
        "–î—ã—Ö–∞–Ω–∏–µ ¬´–≤–æ–ª–Ωa¬ª (–≥—Ä—É–¥—å-–∂–∏–≤–æ—Ç) 5 –º–∏–Ω",
    ],
    "–º–µ–¥–∏—Ç–∞—Ü–∏—è": [
        "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–∞ 5‚Äì10 –º–∏–Ω",
        "–û—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å –Ω–∞ –¥—ã—Ö–∞–Ω–∏–∏ 5‚Äì10 –º–∏–Ω",
        "–ú–µ—Ç—Ç–∞ (–¥–æ–±—Ä–æ—Ç–∞) 5 –º–∏–Ω",
        "5 –æ—â—É—â–µ–Ω–∏–π (—Å–ª—É—Ö/–∑—Ä–µ–Ω–∏–µ/–æ—Å—è–∑–∞–Ω–∏–µ/–≤–∫—É—Å/–∑–∞–ø–∞—Ö) 5 –º–∏–Ω",
        "–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º—ã—Å–ª–µ–π –∫–∞–∫ –æ–±–ª–∞–∫–æ–≤ 5‚Äì10 –º–∏–Ω",
        "–Ø–∫–æ—Ä—å –Ω–∞ –∑–≤—É–∫–µ/—Ç–∞–π–º–µ—Ä–µ 5‚Äì8 –º–∏–Ω",
        "–ú–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≥—É–ª–∫–∞ mindfulness 10 –º–∏–Ω",
        "–ö–æ—Ä–æ—Ç–∫–∞—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å 3 –º–∏–Ω",
        "–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è ¬´—Å–ø–æ–∫–æ–π–Ω–æ–µ –º–µ—Å—Ç–æ¬ª 5‚Äì8 –º–∏–Ω",
        "3-–º–∏–Ω—É—Ç–Ω–∞—è –ø–∞—É–∑–∞ (STOP) 3 –º–∏–Ω",
        "–ú–µ–¥–∏—Ç–∞—Ü–∏—è –ø–µ—Ä–µ–¥ —Å–Ω–æ–º 6‚Äì10 –º–∏–Ω",
        "–ó–∞–∑–µ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ—â—É—â–µ–Ω–∏—è —Å—Ç–æ–ø 5 –º–∏–Ω",
        "–°–æ–∑–µ—Ä—Ü–∞–Ω–∏–µ –ø–ª–∞–º–µ–Ω–∏ (—Ç—Ä–∞—Ç–∞–∫) 3‚Äì5 –º–∏–Ω",
        "–ú—è–≥–∫–∞—è –º–∞–Ω—Ç—Ä–∞ (–º—ã—Å–ª–µ–Ω–Ω–æ) 5‚Äì8 –º–∏–Ω",
        "–ù–µ–Ω–∞–ø—Ä—è–∂–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ ¬´–ø—Ä–æ—Å—Ç–æ –±—ã—Ç—å¬ª 5‚Äì10 –º–∏–Ω",
    ]
}

NUTRITION_TIPS_BASE = [
    "–ü–µ–π –≤–æ–¥—É: —Ü–µ–ª—å 30‚Äì35 –º–ª/–∫–≥/—Å—É—Ç–∫–∏.",
    "–ö–∞–∂–¥—ã–π –ø—Ä–∏—ë–º –ø–∏—â–∏ ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –±–µ–ª–∫–∞ (—Ä—ã–±–∞/—è–π—Ü–∞/–ø—Ç–∏—Ü–∞/—Ç–≤–æ—Ä–æ–≥/–±–æ–±–æ–≤—ã–µ).",
    "–û–≤–æ—â–∏ 400‚Äì600 –≥/–¥–µ–Ω—å, –¥–æ–±–∞–≤–ª—è–π –∫ –∫–∞–∂–¥–æ–º—É –ø—Ä–∏—ë–º—É.",
    "–¶–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤—ã–µ –ª—É—á—à–µ —Ä–∞—Ñ–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö.",
    "–°–ª–∞–¥–∫–∏–µ –Ω–∞–ø–∏—Ç–∫–∏ ‚Üí –∏—Å–∫–ª—é—á–∏—Ç—å, –¥–µ—Å–µ—Ä—Ç—ã ‚Üí –ø–æ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞–º.",
    "–ñ–∏—Ä—ã: –æ–ª–∏–≤–∫–æ–≤–æ–µ/–ª—å–Ω—è–Ω–æ–µ/–æ—Ä–µ—Ö–∏/–∞–≤–æ–∫–∞–¥–æ; –º–µ–Ω—å—à–µ —Ç—Ä–∞–Ω—Å-–∂–∏—Ä–æ–≤.",
    "–ó–∞–≤—Ç—Ä–∞–∫ —Å –±–µ–ª–∫–æ–º (20‚Äì30 –≥) ‚Äî –º–µ–Ω—å—à–µ –ø–µ—Ä–µ–∫—É—Å–æ–≤ –¥–Ω—ë–º.",
    "–ü–ª–∞–Ω–∏—Ä—É–π —Ç–∞—Ä–µ–ª–∫—É: ¬Ω –æ–≤–æ—â–∏, ¬º –±–µ–ª–æ–∫, ¬º —Å–ª–æ–∂–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã.",
    "–§–µ—Ä–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã (–∫–µ—Ñ–∏—Ä/–π–æ–≥—É—Ä—Ç –±–µ–∑ —Å–∞—Ö–∞—Ä–∞, –∫–≤–∞—à–µ–Ω—ã–µ).",
    "–°–æ–ª—å ‚â§5 –≥/—Å—É—Ç–∫–∏, –ø—Ä–∏ –≥–∏–ø–µ—Ä—Ç–æ–Ω–∏–∏ ‚Äî –º–µ–Ω—å—à–µ.",
    "–ê–ª–∫–æ–≥–æ–ª—å ‚Äî –ª—É—á—à–µ –∏—Å–∫–ª—é—á–∏—Ç—å.",
    "–ü–æ—Ä—Ü–∏–∏ –∏–∑–º–µ—Ä—è–π —Ä—É–∫–∞–º–∏: –±–µ–ª–æ–∫ ‚Äî –ª–∞–¥–æ–Ω—å, —É–≥–ª–µ–≤–æ–¥—ã ‚Äî –∫—É–ª–∞–∫, –∂–∏—Ä ‚Äî –±–æ–ª—å—à–æ–π –ø–∞–ª–µ—Ü.",
    "–ö–ª–µ—Ç—á–∞—Ç–∫–∞ 25‚Äì35 –≥/—Å—É—Ç–∫–∏ (–æ–≤–æ—â–∏, —è–≥–æ–¥—ã, –æ—Ç—Ä—É–±–∏).",
    "–ï—à—å –Ω–µ —Å–ø–µ—à–∞: 15‚Äì20 –º–∏–Ω—É—Ç –Ω–∞ –ø—Ä–∏—ë–º –ø–∏—â–∏.",
    "–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∏—ë–º –∑–∞ 2‚Äì3 —á–∞—Å–∞ –¥–æ —Å–Ω–∞.",
    "–ë–∞–ª–∞–Ω—Å –ø–æ –Ω–µ–¥–µ–ª–µ –≤–∞–∂–Ω–µ–µ –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è.",
    "–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–∞—Ö–∞—Ä–∞ (<25‚Äì36 –≥/—Å—É—Ç–∫–∏).",
    "–ù–µ–¥–µ–ª—è ‚Äî –º–µ–Ω—é, –¥–µ–Ω—å ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫.",
    "–°–Ω—ç–∫–∏: –π–æ–≥—É—Ä—Ç –±–µ–∑ —Å–∞—Ö–∞—Ä–∞, —Ç–≤–æ—Ä–æ–≥, –æ—Ä–µ—Ö–∏ 20‚Äì30 –≥, —è–π—Ü–æ, —è–±–ª–æ–∫–æ.",
    "–°–ª–µ–¥–∏ –∑–∞ –∂–µ–ª–µ–∑–æ–º/–≤–∏—Ç–∞–º–∏–Ω–æ–º D —É –≥—Ä—É–ø–ø —Ä–∏—Å–∫–∞ (–ø–æ –∞–Ω–∞–ª–∏–∑–∞–º –∏ –≤—Ä–∞—á—É).",
    "–ë–µ–ª–æ–∫ 1.2‚Äì1.6 –≥/–∫–≥ (–ø—Ä–∏ –ø–æ—Ö—É–¥–µ–Ω–∏–∏) ‚Äî –æ—Ä–∏–µ–Ω—Ç–∏—Ä.",
    "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π —à–∞–≥–∏/–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∞–ø–ø–µ—Ç–∏—Ç.",
    "–ì–æ—Ç–æ–≤—å –±–æ–ª—å—à–∏–º–∏ –ø–∞—Ä—Ç–∏—è–º–∏ –∏ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–π.",
    "–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π –∫–æ—Ñ–µ–∏–Ω –ø–æ—Å–ª–µ 15:00 –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å–æ —Å–Ω–æ–º.",
    "–î–æ–±–∞–≤–ª—è–π —Å–ø–µ—Ü–∏–∏: –∫–æ—Ä–∏—Ü–∞, –∫—É—Ä–∫—É–º–∞, —á–µ—Å–Ω–æ–∫ ‚Äî –ø–æ–ª—å–∑–∞ –∏ –≤–∫—É—Å.",
    "–ù–µ –µ—à—å ¬´–∏–∑ —ç–º–æ—Ü–∏–π¬ª ‚Äî –∑–∞–º–µ–Ω–∏ —Ä–∏—Ç—É–∞–ª–æ–º (—á–∞–π/–ø—Ä–æ–≥—É–ª–∫–∞).",
    "–£–≥–ª–µ–≤–æ–¥—ã –±–ª–∏–∂–µ –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ/–ø–æ—Å–ª–µ –Ω–µ—ë ‚Äî –æ–∫.",
    "–ü—Ä–∏ –ø–æ—Ö—É–¥–µ–Ω–∏–∏: –¥–µ—Ñ–∏—Ü–∏—Ç 10‚Äì20% –æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –∫–∞–ª–æ—Ä–∏–π.",
    "–°—Ç–∞—Ä–∞–π—Å—è –ø–æ–ª—É—á–∞—Ç—å –≤–∏—Ç–∞–º–∏–Ω—ã –∏–∑ –µ–¥—ã; –¥–æ–±–∞–≤–∫–∏ ‚Äî –ø–æ –ø–æ–∫–∞–∑–∞–Ω–∏—è–º –≤—Ä–∞—á–∞.",
    "–ù–µ –Ω–∞–∫–∞–∑—ã–≤–∞–π —Å–µ–±—è ‚Äî –æ–¥–Ω–∞ ¬´–æ—à–∏–±–∫–∞¬ª –Ω–∏—á–µ–≥–æ –Ω–µ –ª–æ–º–∞–µ—Ç.",
]

RECIPES = {
    "–Ω–∏–∑–∫–æ–∫–∞–ª": [
        "–û–º–ª–µ—Ç –∏–∑ 2 —è–∏—Ü —Å —à–ø–∏–Ω–∞—Ç–æ–º –∏ —Ç–æ–º–∞—Ç–∞–º–∏ (~220 –∫–∫–∞–ª, –ë–ñ–£‚âà20/12/6)",
        "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ –Ω–∞ –≥—Ä–∏–ª–µ + —Å–∞–ª–∞—Ç (–æ–ª–∏–≤–∫. –º–∞—Å–ª–æ 1 —á.–ª.) (~300 –∫–∫–∞–ª, 35/10/8)",
        "–¢–≤–æ—Ä–æ–≥ 150 –≥ + —è–≥–æ–¥—ã 100 –≥ (~220 –∫–∫–∞–ª, 20/5/20)",
        "–õ–æ—Å–æ—Å—å –≤ –¥—É—Ö–æ–≤–∫–µ 120 –≥ + –±—Ä–æ–∫–∫–æ–ª–∏ (~320 –∫–∫–∞–ª, 30/18/8)",
        "–°—É–ø-–ø—é—Ä–µ –∏–∑ —Ç—ã–∫–≤—ã —Å –π–æ–≥—É—Ä—Ç–æ–º (~250 –∫–∫–∞–ª, 8/8/30)",
        "–ì—Ä–µ—á–µ—Å–∫–∏–π —Å–∞–ª–∞—Ç (–±–µ–∑ —Ö–ª–µ–±–∞) (~280 –∫–∫–∞–ª, 10/18/16)",
        "–¢—É–Ω–µ—Ü + –æ–≥—É—Ä–µ—Ü + –π–æ–≥—É—Ä—Ç —Å–æ —Å–ø–µ—Ü–∏—è–º–∏ (~250 –∫–∫–∞–ª, 30/6/10)",
        "–ò–Ω–¥–µ–π–∫–∞ —Ç—É—à—ë–Ω–∞—è + —Ü–≤–µ—Ç–Ω–∞—è –∫–∞–ø—É—Å—Ç–∞ (~300 –∫–∫–∞–ª, 32/12/10)",
        "–§—Ä–∏—Ç—Ç–∞—Ç–∞ –æ–≤–æ—â–Ω–∞—è (~260 –∫–∫–∞–ª, 16/14/18)",
        "–ó–∞–ø–µ—á—ë–Ω–Ω—ã–µ –æ–≤–æ—â–∏ + —Ñ–µ—Ç–∞ 40 –≥ (~280 –∫–∫–∞–ª, 10/16/20)",
    ],
    "–±–∞–ª–∞–Ω—Å": [
        "–ì—Ä–µ—á–∫–∞ 60 –≥ (—Å—É—Ö.) + –∫—É—Ä. –±–µ–¥—Ä–æ 120 –≥ + —Å–∞–ª–∞—Ç (~520 –∫–∫–∞–ª, 35/18/55)",
        "–†–∏—Å –±–∞—Å–º–∞—Ç–∏ 60 –≥ + –ª–æ—Å–æ—Å—å 120 –≥ + –æ–≤–æ—â–∏ (~560 –∫–∫–∞–ª, 32/22/55)",
        "–ü–∞—Å—Ç–∞ —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω. 70 –≥ + —Ç–æ–º–∞—Ç–Ω—ã–π —Å–æ—É—Å + –º–æ—Ü–∞—Ä–µ–ª–ª–∞ 40 –≥ (~550 –∫–∫–∞–ª, 22/17/70)",
        "–õ–∞–≤–∞—à —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω. + —Ö—É–º—É—Å + –æ–≤–æ—â–∏ + –∫—É—Ä–∏—Ü–∞ (~500 –∫–∫–∞–ª, 35/14/55)",
        "–ß–∏–ª–∏ —Å –∏–Ω–¥–µ–π–∫–æ–π –∏ —Ñ–∞—Å–æ–ª—å—é (~540 –∫–∫–∞–ª, 38/16/60)",
        "–ü–ª–æ–≤ ¬´–ª–∞–π—Ç¬ª: —Ä–∏—Å+–∏–Ω–¥–µ–π–∫–∞+–æ–≤–æ—â–∏ (~560 –∫–∫–∞–ª, 32/16/70)",
        "–ë—É—Ä—Ä–∏—Ç–æ-–±–æ—É–ª: —Ä–∏—Å+—á—ë—Ä–Ω–∞—è —Ñ–∞—Å–æ–ª—å+–∫—É—Ä–∏—Ü–∞ (~580 –∫–∫–∞–ª, 35/14/75)",
        "–ö–∞—Ä—Ä–∏ –∏–∑ –Ω—É—Ç–∞ —Å —Ä–∏—Å–æ–º (~520 –∫–∫–∞–ª, 16/14/80)",
        "–°–æ–±–∞ + —Ç–æ—Ñ—É + –æ–≤–æ—â–∏ (~520 –∫–∫–∞–ª, 24/16/70)",
        "–ü–æ–∫–µ-–±–æ—É–ª: —Ä–∏—Å+—Ä—ã–±–∞+–æ–≤–æ—â–∏ (~560 –∫–∫–∞–ª, 28/18/70)",
    ],
    "–º–∞—Å—Å–∞": [
        "–û–≤—Å—è–Ω–∫–∞ 80 –≥ + –º–æ–ª–æ–∫–æ + –±–∞–Ω–∞–Ω + –∞—Ä–∞—Ö. –ø–∞—Å—Ç–∞ (~650 –∫–∫–∞–ª, 20/22/90)",
        "–ü–∞—Å—Ç–∞ + —Ç—É–Ω–µ—Ü + –æ–ª–∏–≤–∫. –º–∞—Å–ª–æ (~700 –∫–∫–∞–ª, 28/26/90)",
        "–†–∏—Å + –≥–æ–≤—è–¥–∏–Ω–∞ + –∞–≤–æ–∫–∞–¥–æ (~720 –∫–∫–∞–ª, 35/28/80)",
        "–¢–æ—Ä—Ç–∏–ª—å—è —Å –∫—É—Ä–∏—Ü–µ–π, —Å—ã—Ä–æ–º –∏ –æ–≤–æ—â–∞–º–∏ (~680 –∫–∫–∞–ª, 40/22/75)",
        "–°–º—É–∑–∏: –º–æ–ª–æ–∫–æ+–±–∞–Ω–∞–Ω+—Ç–≤–æ—Ä–æ–≥+–æ–≤—Å—è–Ω–∫–∞+–º—ë–¥ (~650 –∫–∫–∞–ª, 35/10/95)",
        "–ë—É–ª–≥—É—Ä + –ª–æ—Å–æ—Å—å + —Ç–∞—Ö–∏–Ω–∏ (~720 –∫–∫–∞–ª, 35/30/75)",
        "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ø–µ—á—ë–Ω—ã–π + —Ç–≤–æ—Ä–æ–≥ + –ª–æ—Å–æ—Å—å (~680 –∫–∫–∞–ª, 35/22/80)",
        "–û–º–ª–µ—Ç 3 —è–π—Ü–∞ + —Å—ã—Ä + —Ç–æ—Å—Ç —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω. (~650 –∫–∫–∞–ª, 35/38/30)",
        "–ö—É—Å–∫—É—Å + –±–∞—Ä–∞–Ω–∏–Ω–∞ + –æ–≤–æ—â–∏ (~700 –∫–∫–∞–ª, 35/25/85)",
        "–ß–µ—á–µ–≤–∏—Ü–∞ + –∫—É—Ä–∏—Ü–∞ + –æ–ª–∏–≤–∫. –º–∞—Å–ª–æ (~680 –∫–∫–∞–ª, 45/18/70)",
    ]
}

ANALYSIS_INFO = {
    "–≥–µ–º–æ–≥–ª–æ–±–∏–Ω": "–ù–æ—Ä–º–∞ ~130‚Äì170 –≥/–ª (–º), 120‚Äì150 –≥/–ª (–∂). –ù–∏–∑–∫–∏–π ‚Äî –≤–æ–∑–º–æ–∂–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç –∂–µ–ª–µ–∑–∞/–∫—Ä–æ–≤–æ–ø–æ—Ç–µ—Ä—è; –≤—ã—Å–æ–∫–∏–π ‚Äî –æ–±–µ–∑–≤–æ–∂–∏–≤–∞–Ω–∏–µ/–≥–∏–ø–æ–∫—Å–∏—è. –û–±—Å—É–¥–∏ —Å –≤—Ä–∞—á–æ–º.",
    "—Ñ–µ—Ä—Ä–∏—Ç–∏–Ω": "–°–∫–ª–∞–¥ –∂–µ–ª–µ–∑–∞. –û—Ä–∏–µ–Ω—Ç–∏—Ä ~30‚Äì300 –Ω–≥/–º–ª (—Ä–∞–∑–±—Ä–æ—Å), –Ω–∏–∂–µ 30 ‚Äî —á–∞—Å—Ç–æ –¥–µ—Ñ–∏—Ü–∏—Ç –∑–∞–ø–∞—Å–æ–≤. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —É –≤—Ä–∞—á–∞.",
    "–∂–µ–ª–µ–∑–æ": "–°—ã–≤–æ—Ä–æ—Ç–æ—á–Ω–æ–µ –∂–µ–ª–µ–∑–æ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è; –æ—Ü–µ–Ω–∏–≤–∞–π –≤–º–µ—Å—Ç–µ —Å —Ñ–µ—Ä—Ä–∏—Ç–∏–Ω–æ–º/–û–ñ–°–°/–¢–ñ–°–°.",
    "–≤–∏—Ç–∞–º–∏–Ω_d": "25(OH)D: –¥–µ—Ñ–∏—Ü–∏—Ç <20 –Ω–≥/–º–ª, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å 20‚Äì30, —Ü–µ–ª—å 30‚Äì50. –î–æ–∑–∏—Ä–æ–≤–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ –≤—Ä–∞—á—É.",
    "—Ç—Ç–≥": "–©–∏—Ç–æ–≤–∏–¥–∫–∞: —Ä–µ—Ñ. ~0.4‚Äì4.0 –º–ï–¥/–ª. –ü–æ–≤—ã—à–µ–Ω ‚Äî —á–∞—Å—Ç–æ –≥–∏–ø–æ—Ñ—É–Ω–∫—Ü–∏—è, —Å–Ω–∏–∂–µ–Ω ‚Äî –≥–∏–ø–µ—Ä—Ñ—É–Ω–∫—Ü–∏—è. –ù—É–∂–Ω–∞ –æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞.",
    "–≥–ª—é–∫–æ–∑–∞": "–ù–∞—Ç–æ—â–∞–∫ ~3.9‚Äì5.5 –º–º–æ–ª—å/–ª. –í—ã—à–µ ‚Äî –ø–µ—Ä–µ—Å–¥–∞—Ç—å/–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è.",
    "hba1c": "–ì–ª–∏–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Hb: <5.7% –Ω–æ—Ä–º–∞, 5.7‚Äì6.4 –ø—Ä–µ–¥–¥–∏–∞–±–µ—Ç, ‚â•6.5 –¥–∏–∞–±–µ—Ç (–ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º). –£—Ç–æ—á–Ω—è–π —É –≤—Ä–∞—á–∞.",
    "–ª–¥–ª": "¬´–ü–ª–æ—Ö–æ–π¬ª —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω; —á–µ–º –Ω–∏–∂–µ, —Ç–µ–º –ª—É—á—à–µ –ø—Ä–∏ —Ä–∏—Å–∫–∞—Ö. –¶–µ–ª–µ–≤—ã–µ ‚Äî –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã.",
    "hdl": "¬´–•–æ—Ä–æ—à–∏–π¬ª —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω; –≤—ã—à–µ ‚Äî –ª—É—á—à–µ (–≤ —Ä–∞–∑—É–º–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö).",
    "—Ç—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥—ã": "–í—ã—Å–æ–∫–∏–µ –¢–ì ‚Äî —Ä–∏—Å–∫ –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π; —Ü–µ–ª—å <1.7 –º–º–æ–ª—å/–ª.",
    "–∞–ª—Ç": "–ü–µ—á—ë–Ω–æ—á–Ω—ã–µ —Ñ–µ—Ä–º–µ–Ω—Ç—ã: –ê–õ–¢/–ê–°–¢ –ø–æ–≤—ã—à–µ–Ω—ã ‚Äî –ø–æ–≤–æ–¥ –∫ –æ—Ü–µ–Ω–∫–µ –ø–µ—á–µ–Ω–∏.",
    "–∞—Å—Ç": "–°–º–æ—Ç—Ä–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ê–õ–¢; —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ç–æ–∂–µ –≤–∞–∂–Ω–æ.",
    "–±–∏–ª–∏—Ä—É–±–∏–Ω": "–í—ã—Å–æ–∫–∏–π ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –æ—Ç—Ç–æ–∫–∞/–ø–µ—á–µ–Ω–∏/–≥–µ–º–æ–ª–∏–∑; –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —É –≤—Ä–∞—á–∞.",
    "–∫—Ä–µ–∞—Ç–∏–Ω–∏–Ω": "–û—Ü–µ–Ω–∫–∞ –ø–æ—á–µ–∫; —Å —Ä–æ—Å—Ç–æ–º –∫—Ä–µ–∞—Ç–∏–Ω–∏–Ω–∞ –ø–∞–¥–∞–µ—Ç –°–ö–§.",
    "–º–æ—á–µ–≤–∏–Ω–∞": "–û–±–º–µ–Ω –±–µ–ª–∫–∞/–ø–æ—á–µ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è; —Å–º–æ—Ç—Ä–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Å–µ.",
    "crp": "–°-—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π –±–µ–ª–æ–∫: –º–∞—Ä–∫—ë—Ä –≤–æ—Å–ø–∞–ª–µ–Ω–∏—è/—Ä–∏—Å–∫–∞; –æ—Ü–µ–Ω–∫–∞ –¥–∏–Ω–∞–º–∏–∫–∏ —É –≤—Ä–∞—á–∞.",
    "—Å–æ—ç": "–ù–µ—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ; –ø–æ–≤—ã—à–µ–Ω–æ –ø—Ä–∏ –≤–æ—Å–ø–∞–ª–µ–Ω–∏–∏/–∞–Ω–µ–º–∏–∏ –∏ –¥—Ä.",
    "–ª–µ–π–∫–æ—Ü–∏—Ç—ã": "–ò–º–º—É–Ω–∏—Ç–µ—Ç; –≤—ã—Å–æ–∫–∏–µ ‚Äî –∏–Ω—Ñ–µ–∫—Ü–∏—è/–≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ; –Ω–∏–∑–∫–∏–µ ‚Äî —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã.",
    "—Ç—Ä–æ–º–±–æ—Ü–∏—Ç—ã": "–°–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ; –∏ –≤—ã—Å–æ–∫–∏–µ, –∏ –Ω–∏–∑–∫–∏–µ —Ç—Ä–µ–±—É—é—Ç –æ—Ü–µ–Ω–∫–∏.",
    "—ç—Ä–∏—Ç—Ä–æ—Ü–∏—Ç—ã": "–ü–µ—Ä–µ–Ω–æ—Å—è—Ç –∫–∏—Å–ª–æ—Ä–æ–¥; —Å–º–æ—Ç—Ä–∏ —Å Hb/–≥–µ–º–∞—Ç–æ–∫—Ä–∏—Ç–æ–º.",
    "–≥–µ–º–∞—Ç–æ–∫—Ä–∏—Ç": "–î–æ–ª—è —Ñ–æ—Ä–º–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤; –≤–ª–∏—è–µ—Ç –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è.",
    "–º–∞–≥–Ω–∏–π": "–î–µ—Ñ–∏—Ü–∏—Ç ‚Äî —Å—É–¥–æ—Ä–æ–≥–∏/—É—Ç–æ–º–ª—è–µ–º–æ—Å—Ç—å; –Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–ª–æ–∂–Ω–∞.",
    "–∫–∞–ª–∏–π": "–°–µ—Ä–¥—Ü–µ/–º—ã—à—Ü—ã; –∏ –Ω–∏–∑–∫–∏–π, –∏ –≤—ã—Å–æ–∫–∏–π –æ–ø–∞—Å–Ω—ã ‚Äî —Å—Ä–æ—á–Ω–æ –∫ –≤—Ä–∞—á—É –ø—Ä–∏ —Å–∏–º–ø—Ç–æ–º–∞—Ö.",
    "–Ω–∞—Ç—Ä–∏–π": "–í–æ–¥–Ω—ã–π –±–∞–ª–∞–Ω—Å; –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è ‚Äî –∫ –≤—Ä–∞—á—É.",
}

# ======== –ö–æ–º–∞–Ω–¥—ã ========

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = u(update.effective_user.id)
    name = user["name"] or update.effective_user.first_name
    text = (
        f"üëã –ü—Ä–∏–≤–µ—Ç, {name}!\n"
        "–Ø LifeRhythm ‚Äî —Ç–≤–æ–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –∑–¥–æ—Ä–æ–≤—å—é –∏ —ç–Ω–µ—Ä–≥–∏–∏.\n\n"
        "–ü–æ–ø—Ä–æ–±—É–π:\n"
        "‚Ä¢ /set name=–ò–≤–∞–Ω height=180 weight=82 sex=–º dob=1992-05-12 goal=–ø–æ—Ö—É–¥–µ–Ω–∏–µ\n"
        "‚Ä¢ /water 300 ‚Äî –æ—Ç–º–µ—Ç–∏—Ç—å –≤–æ–¥—É\n"
        "‚Ä¢ /exercise goal=–∑–∞—Ä—è–¥–∫–∞ level=–Ω–æ–≤–∏—á–æ–∫ count=8\n"
        "‚Ä¢ /yoga level=–Ω–æ–≤–∏—á–æ–∫ count=6\n"
        "‚Ä¢ /meditation type=–¥—ã—Ö–∞–Ω–∏–µ count=6\n"
        "‚Ä¢ /nutrition goal=–∑–¥–æ—Ä–æ–≤—å–µ count=10\n"
        "‚Ä¢ /recipes goal=–Ω–∏–∑–∫–æ–∫–∞–ª count=6\n"
        "‚Ä¢ /analysis –≤–∏—Ç–∞–º–∏–Ω_d\n"
        "‚Ä¢ /biorhythm ‚Äî —Ä–∞—Å—á–µ—Ç –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è\n"
        "‚Ä¢ /idealweight ‚Äî –ò–ú–¢ –∏ –¥–∏–∞–ø–∞–∑–æ–Ω—ã\n"
        "‚Ä¢ /status ‚Äî —Å–≤–æ–¥–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è"
    )
    await send_long(update, text)

async def help_cmd(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await start(update, context)

async def status(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = u(update.effective_user.id)
    text = (
        "üìä –°—Ç–∞—Ç—É—Å:\n"
        f"–ò–º—è: {user['name']}\n"
        f"–ü–æ–ª: {user['sex']}\n"
        f"–†–æ—Å—Ç: {user['height']} —Å–º\n"
        f"–í–µ—Å: {user['weight']} –∫–≥\n"
        f"–¶–µ–ª—å: {user['goal']}\n"
        f"–î–†: {user['dob']}\n"
        f"–í–æ–¥–∞ —Å–µ–≥–æ–¥–Ω—è: {user['water_total']} –º–ª\n"
        "–ö–æ–º–∞–Ω–¥—ã: /set /water /exercise /yoga /meditation /nutrition /recipes /analysis /biorhythm /idealweight"
    )
    await update.message.reply_text(text)

async def set_cmd(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = u(update.effective_user.id)
    data = parse_kv(context.args)
    mapping = {
        "name": "name",
        "sex": "sex",
        "–ø–æ–ª": "sex",
        "height": "height",
        "—Ä–æ—Å—Ç": "height",
        "weight": "weight",
        "–≤–µ—Å": "weight",
        "dob": "dob",
        "–¥—Ä": "dob",
        "goal": "goal",
        "—Ü–µ–ª—å": "goal",
    }
    applied = []
    for k, v in data.items():
        key = mapping.get(k)
        if not key:
            continue
        if key in ("height", "weight"):
            try:
                user[key] = int(v)
            except:
                continue
        else:
            user[key] = v
        applied.append(f"{key}={user[key]}")
    if applied:
        await update.message.reply_text("‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ: " + ", ".join(applied))
    else:
        await update.message.reply_text("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /set name=–ò–≤–∞–Ω height=180 weight=82 sex=–º dob=1992-05-12 goal=–ø–æ—Ö—É–¥–µ–Ω–∏–µ")

async def water(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = u(update.effective_user.id)
    amount = 250
    if context.args:
        try:
            amount = int(context.args[0])
        except:
            pass
    user["water_total"] += max(0, amount)
    target = 2000
    await update.message.reply_text(f"üíß –û—Ç–º–µ—á–µ–Ω–æ {amount} –º–ª. –í—Å–µ–≥–æ —Å–µ–≥–æ–¥–Ω—è: {user['water_total']} –º–ª (—Ü–µ–ª—å ~{target} –º–ª).")

def build_exercise_text(goal: str, level: str, count: int) -> str:
    goal = goal or "–∑–∞—Ä—è–¥–∫–∞"
    pool = EXERCISE_BLOCKS.get(goal, [])
    if not pool:
        all_blocks = sum(EXERCISE_BLOCKS.values(), [])
        chosen = pick_many(all_blocks, count)
    else:
        chosen = pick_many(pool, min(count, len(pool)))
    title = f"üèÉ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî {goal.capitalize()}, —É—Ä–æ–≤–µ–Ω—å: {level or '–ª—é–±–æ–π'}"
    lines = [f"{i+1}. {ex}" for i, ex in enumerate(chosen)]
    lines.append("‚è± –û—Ç–¥—ã—Ö 30‚Äì45 —Å–µ–∫ –º–µ–∂–¥—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏. 2‚Äì3 –∫—Ä—É–≥–∞.")
    return title + "\n" + "\n".join(lines)

async def exercise(update: Update, context: ContextTypes.DEFAULT_TYPE):
    # –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: goal=..., level=..., count=...
    params = parse_kv(context.args)
    goal = params.get("goal")
    level = params.get("level", "–Ω–æ–≤–∏—á–æ–∫")
    try:
        count = int(params.get("count", "8"))
    except:
        count = 8
    text = build_exercise_text(goal, level, count)
    await send_long(update, text)

async def yoga(update: Update, context: ContextTypes.DEFAULT_TYPE):
    params = parse_kv(context.args)
    try:
        count = int(params.get("count", "6"))
    except:
        count = 6
    poses = pick_many(YOGA_POSES, min(count, len(YOGA_POSES)))
    title = f"üßò –ô–æ–≥–∞/—Ä–∞—Å—Ç—è–∂–∫–∞ ‚Äî {params.get('level','–Ω–æ–≤–∏—á–æ–∫')}"
    text = title + "\n" + "\n".join(f"{i+1}. {p}" for i, p in enumerate(poses)) + "\n" + "–î—ã—à–∏ —Å–ø–æ–∫–æ–π–Ω–æ, –±–µ–∑ –±–æ–ª–∏."
    await send_long(update, text)

async def meditation(update: Update, context: ContextTypes.DEFAULT_TYPE):
    params = parse_kv(context.args)
    typ = params.get("type", "–¥—ã—Ö–∞–Ω–∏–µ")
    try:
        count = int(params.get("count", "6"))
    except:
        count = 6
    pool = BREATH_MEDIT.get(typ, BREATH_MEDIT["–¥—ã—Ö–∞–Ω–∏–µ"])
    chosen = pick_many(pool, min(count, len(pool)))
    title = f"üß† {typ.capitalize()} ‚Äî –ø–æ–¥–±–æ—Ä–∫–∞"
    text = title + "\n" + "\n".join(f"{i+1}. {p}" for i, p in enumerate(chosen))
    await send_long(update, text)

async def nutrition(update: Update, context: ContextTypes.DEFAULT_TYPE):
    params = parse_kv(context.args)
    try:
        count = int(params.get("count", "12"))
    except:
        count = 12
    tips = pick_many(NUTRITION_TIPS_BASE, min(count, len(NUTRITION_TIPS_BASE)))
    head = f"ü•ó –°–æ–≤–µ—Ç—ã –ø–æ –ø–∏—Ç–∞–Ω–∏—é ‚Äî {params.get('goal','–æ–±—â–∏–µ')}"
    await send_long(update, head + "\n" + "\n".join(f"‚Ä¢ {t}" for t in tips))

async def recipes(update: Update, context: ContextTypes.DEFAULT_TYPE):
    params = parse_kv(context.args)
    goal = params.get("goal", "–Ω–∏–∑–∫–æ–∫–∞–ª")
    try:
        count = int(params.get("count", "6"))
    except:
        count = 6
    pool = RECIPES.get(goal, RECIPES["–Ω–∏–∑–∫–æ–∫–∞–ª"])
    chosen = pick_many(pool, min(count, len(pool)))
    head = f"üçΩ –†–µ—Ü–µ–ø—Ç—ã ({goal})"
    await send_long(update, head + "\n" + "\n".join(f"{i+1}. {r}" for i, r in enumerate(chosen)))

async def analysis(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if not context.args:
        keys = ", ".join(sorted(ANALYSIS_INFO.keys())[:12]) + ", ..."
        await update.message.reply_text(f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /analysis –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å\n–ù–∞–ø—Ä.: /analysis –≤–∏—Ç–∞–º–∏–Ω_d\n–î–æ—Å—Ç—É–ø–Ω–æ: {keys}")
        return
    key = " ".join(context.args).strip().lower()
    key = key.replace(" ", "_")
    info = ANALYSIS_INFO.get(key)
    if info:
        await update.message.reply_text(f"üß™ {key.replace('_',' ').title()}:\n{info}\n\n–≠—Ç–æ –Ω–µ –¥–∏–∞–≥–Ω–æ–∑ ‚Äî –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å –ª–µ—á–∞—â–∏–º –≤—Ä–∞—á–æ–º.")
    else:
        await update.message.reply_text("–ü–æ–∫–∞ –Ω–µ—Ç —Å–ø—Ä–∞–≤–∫–∏ –ø–æ —ç—Ç–æ–º—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—é. –ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–π (vitamin_d ‚Üí ¬´–≤–∏—Ç–∞–º–∏–Ω_d¬ª).")

def calc_biorhythm(dob: str, on_date: date) -> str:
    try:
        bd = datetime.strptime(dob, "%Y-%m-%d").date()
    except:
        return "–£–∫–∞–∂–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ /set dob=YYYY-MM-DD"
    days = (on_date - bd).days
    def phase(period):
        return math.sin(2 * math.pi * days / period)
    def pct(x):  # -100..100
        return int(round(x * 100))
    phys = pct(phase(23))
    emot = pct(phase(28))
    intel = pct(phase(33))
    return (f"üìà –ë–∏–æ—Ä–∏—Ç–º—ã –Ω–∞ {on_date.isoformat()}:\n"
            f"–§–∏–∑–∏—á–µ—Å–∫–∏–π: {phys:+d}%\n"
            f"–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π: {emot:+d}%\n"
            f"–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π: {intel:+d}%\n"
            "–≠—Ç–æ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–∏ÃÜ —Å —Ä–∞–∑—É–º–æ–º üòâ")

async def biorhythm(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = u(update.effective_user.id)
    if not user["dob"]:
        await update.message.reply_text("–°–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è: /set dob=YYYY-MM-DD")
        return
    today = date.today()
    await update.message.reply_text(calc_biorhythm(user["dob"], today))

async def idealweight(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = u(update.effective_user.id)
    h = user["height"]
    w = user["weight"]
    if not h or not w:
        await update.message.reply_text("–£–∫–∞–∂–∏ —Ä–æ—Å—Ç –∏ –≤–µ—Å: /set height=180 weight=82")
        return
    h_m = h / 100.0
    bmi = w / (h_m ** 2)
    # –î–∏–∞–ø–∞–∑–æ–Ω—ã –í–û–ó
    cat = ("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≤–µ—Å" if bmi < 18.5 else
           "–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –≤–µ—Å" if bmi < 25 else
           "–ò–∑–±—ã—Ç–æ—á–Ω—ã–π" if bmi < 30 else
           "–û–∂–∏—Ä–µ–Ω–∏–µ")
    # –ü—Ä–æ—Å—Ç–µ–π—à–∞—è ¬´–∏–¥–µ–∞–ª–∫–∞¬ª –î–µ–≤–∏–Ω–∞/–ë—Ä–æ–∫–∞ (—É—Å–ª–æ–≤–Ω–æ)
    brock = (h - 100) * (0.9 if user["sex"] == "–º" else 0.85)
    text = (
        f"üìè –†–æ—Å—Ç: {h} —Å–º, –í–µ—Å: {w} –∫–≥\n"
        f"–ò–ú–¢: {bmi:.1f} ‚Äî {cat}\n"
        f"–û—Ä–∏–µ–Ω—Ç–∏—Ä ¬´–∏–¥–µ–∞–ª—å–Ω–æ–≥–æ¬ª –ø–æ –ë—Ä–æ–∫—É: ~{brock:.0f} –∫–≥ (–æ—á–µ–Ω—å –≥—Ä—É–±–æ)\n"
        "–≠—Ç–æ –æ—Ü–µ–Ω–∫–∞ –¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–∞. –†–µ—à–µ–Ω–∏—è ‚Äî —Å –≤—Ä–∞—á–æ–º/—Ç—Ä–µ–Ω–µ—Ä–æ–º."
    )
    await update.message.reply_text(text)

# ======== Flask keep-alive (–¥–ª—è Render free) ========
app_web = Flask(__name__)

@app_web.route("/")
def root():
    return "LifeRhythm: OK"

@app_web.route("/healthz")
def healthz():
    return "ok"

def run_flask():
    port = int(os.getenv("PORT", "10000"))
    app_web.run(host="0.0.0.0", port=port)

# ======== –ó–∞–ø—É—Å–∫ PTB v21 ========
def run_bot():
    application = Application.builder().token(BOT_TOKEN).build()
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("help", help_cmd))
    application.add_handler(CommandHandler("status", status))
    application.add_handler(CommandHandler("set", set_cmd))
    application.add_handler(CommandHandler("water", water))
    application.add_handler(CommandHandler("exercise", exercise))
    application.add_handler(CommandHandler("yoga", yoga))
    application.add_handler(CommandHandler("meditation", meditation))
    application.add_handler(CommandHandler("nutrition", nutrition))
    application.add_handler(CommandHandler("recipes", recipes))
    application.add_handler(CommandHandler("analysis", analysis))
    application.add_handler(CommandHandler("biorhythm", biorhythm))
    application.add_handler(CommandHandler("idealweight", idealweight))
    application.run_polling(close_loop=False)

if __name__ == "__main__":
    threading.Thread(target=run_flask, daemon=True).start()
    run_bot()
