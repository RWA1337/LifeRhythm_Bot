# main.py
import os
import json
import random
import datetime
from typing import List, Dict

from flask import Flask, request, jsonify
import telebot
from telebot import types

# ---------- –ö–û–ù–§–ò–ì ----------
BOT_TOKEN = os.environ.get("BOT_TOKEN")
PUBLIC_URL = os.environ.get("PUBLIC_URL", "").rstrip("/")
PORT = int(os.environ.get("PORT", 10000))

if not BOT_TOKEN:
    raise RuntimeError("–£—Å—Ç–∞–Ω–æ–≤–∏ BOT_TOKEN –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.")
if not PUBLIC_URL:
    raise RuntimeError("–£—Å—Ç–∞–Ω–æ–≤–∏ PUBLIC_URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä https://liferhythm-bot.onrender.com")

WEBHOOK_PATH = "/webhook"
WEBHOOK_URL = f"{PUBLIC_URL}{WEBHOOK_PATH}"

DATA_FILE = "liferhythm_data.json"  # –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (json)

bot = telebot.TeleBot(BOT_TOKEN)
app = Flask(__name__)

# ---------- –£–¢–ò–õ–ò–¢–´ ----------
def load_data() -> dict:
    try:
        with open(DATA_FILE, "r", encoding="utf-8") as f:
            return json.load(f)
    except Exception:
        return {"users": {}}  # users: {chat_id: { "water": {date: ml}, "dob": "YYYY-MM-DD" } }

def save_data(data: dict):
    try:
        with open(DATA_FILE, "w", encoding="utf-8") as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
    except Exception as e:
        print("SAVE ERROR:", e)

def today_str() -> str:
    return datetime.date.today().isoformat()

def parse_n_from_text(text: str, default: int, min_v: int, max_v: int) -> int:
    # –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ —á–∏—Å–ª–æ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏, –∏–Ω–∞—á–µ default
    parts = text.strip().split()
    for p in parts:
        if p.isdigit():
            n = int(p)
            return max(min_v, min(max_v, n))
    return default

# ---------- –ö–û–ù–¢–ï–ù–¢ (–º–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤) ----------
# –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (20 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
EXERCISES = [
    {"title": "–£—Ç—Ä–µ–Ω–Ω–∏–π —Ç–æ–Ω—É—Å (10 –º–∏–Ω—É—Ç)", "steps": ["–ü–æ—Ç—è–≥–∏–≤–∞–Ω–∏—è 30 —Å", "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è 15", "–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å—Ç–µ–Ω—ã 10", "–ü–ª–∞–Ω–∫–∞ 40 —Å", "–•–æ–¥—å–±–∞ –Ω–∞ –º–µ—Å—Ç–µ 60 —Å"]},
    {"title": "–ö–∞—Ä–¥–∏–æ-–±—ã—Å—Ç—Ä–æ (8 –º–∏–Ω)", "steps": ["–î–∂–∞–º–ø–∏–Ω–≥ –¥–∂–µ–∫ 40 —Å", "–ë–µ–≥ –Ω–∞ –º–µ—Å—Ç–µ 40 —Å", "–ü—Ä—ã–∂–∫–∏ —Å –ø–æ–¥—ä–µ–º–æ–º –∫–æ–ª–µ–Ω 30 —Å", "–û—Ç–¥—ã—Ö 30 —Å", "–ü–æ–≤—Ç–æ—Ä 2 –∫—Ä—É–≥–∞"]},
    {"title": "–°–∏–ª–∞ –∫–æ—Ä–ø—É—Å–∞", "steps": ["–ü–ª–∞–Ω–∫–∞ 3√ó30 —Å", "–ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞ 2√ó20 —Å", "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 3√ó20", "–ù–æ–∂–Ω–∏—Ü—ã 3√ó30"]},
    {"title": "–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã", "steps": ["–ü—Ä–∏—Å–µ–¥ 3√ó15", "–í—ã–ø–∞–¥—ã 3√ó10/–Ω–æ–≥–∞", "–ú–æ—Å—Ç —è–≥–æ–¥–∏—á–Ω—ã–π 3√ó15", "–ü–æ–¥—ä—ë–º –Ω–∞ –Ω–æ—Å–∫–∏ 3√ó20"]},
    {"title": "–°–ø–∏–Ω–∞ –∏ –æ—Å–∞–Ω–∫–∞", "steps": ["–°—É–ø–µ—Ä–º–µ–Ω 3√ó12", "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç 3√ó15", "–†–∞—Å—Ç—è–∂–∫–∞ –ø–æ—è—Å–Ω–∏—Ü—ã 60 —Å"]},
    {"title": "–û—Ñ–∏—Å-–º–∏–∫—Ä–æ (5 –º–∏–Ω)", "steps": ["–ö—Ä—É–≥–∏ –ø–ª–µ—á–∞–º–∏ 30 —Å", "–†–∞—Å—Ç—è–∂–∫–∞ —à–µ–∏ 30 —Å", "–ù–∞–∫–ª–æ–Ω—ã 10 —Ä–∞–∑", "–°–≤–µ–¥–µ–Ω–∏–µ –ª–æ–ø–∞—Ç–æ–∫ 20 —Ä–∞–∑"]},
    {"title": "HIIT-6", "steps": ["30 —Å —Ö–æ–¥—å–±–∞/30 —Å –ø—Ä—ã–∂–∫–∏ √ó6", "–û—Ç–¥—ã—Ö 60 —Å", "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–∏ —Å–∏–ª–µ"]},
    {"title": "–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Ä—É–∫", "steps": ["–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å—Ç—É–ª–∞ 3√ó10", "–û–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è 3√ó8", "–ò–∑–æ–º–µ—Ç—Ä–∏—è 30 —Å"]},
    {"title": "–ë–∞–ª–∞–Ω—Å –∏ –Ω–æ–≥–∏", "steps": ["–ë–∞–ª–∞–Ω—Å –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ 2√ó30 —Å", "–ë–æ–∫–æ–≤—ã–µ –≤—ã–ø–∞–¥—ã 3√ó12", "–†–∞—Å—Ç—è–∂–∫–∞ 60 —Å"]},
    {"title": "–õ—ë–≥–∫–æ–µ –∫–∞—Ä–¥–∏–æ (20 –º–∏–Ω)", "steps": ["–•–æ–¥—å–±–∞ / —Å—Ç–µ–ø 20 –º–∏–Ω—É—Ç, –ø—É–ª—å—Å –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π"]},
    {"title": "–ö–æ—Ä-—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å", "steps": ["–ü–ª–∞–Ω–∫–∞ –Ω–∞ –ª–æ–∫—Ç—è—Ö 3√ó40 —Å", "–†—É—Å—Å–∫–∏–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 3√ó20", "–ü–ª–∞–Ω–∫–∞ —Å –ø–æ–¥—ä–µ–º–æ–º –Ω–æ–≥–∏ 2√ó10/–Ω–æ–≥–∞"]},
    {"title": "–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è –ª–µ—Å—Ç–Ω–∏—Ü–∞", "steps": ["40 —Å —Ä–∞–±–æ—Ç–∞ / 20 —Å –æ—Ç–¥—ã—Ö —Ö8: –±–µ–≥, –ø—Ä—ã–∂–∫–∏, –ø—Ä–∏—Å–µ–¥"]},
    {"title": "–ü–æ–ª–Ω—ã–π –∫—Ä—É–≥ 12 –º–∏–Ω", "steps": ["–ü—Ä–∏—Å–µ–¥ 40 —Å", "–û—Ç–∂–∏–º 30 —Å", "–ü–ª–∞–Ω–∫–∞ 30 —Å", "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 40 —Å"]},
    {"title": "–†–∞—Å—Ç—è–∂–∫–∞ –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã", "steps": ["–†–∞—Å—Ç—è–∂–∫–∞ –∑–∞–¥–Ω–µ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –±–µ–¥—Ä–∞ 30 —Å", "–ö–≤–∞–¥—Ä–∏—Ü–µ–ø—Å 30 —Å", "–ü–æ—è—Å–Ω–∏—Ü–∞ 30 —Å", "–ü–æ–∑–∞ —Ä–µ–±—ë–Ω–∫–∞ 60 —Å"]},
    {"title": "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª‚Äî–¥–æ–º", "steps": ["–ü–æ–¥—ä—ë–º—ã —Å–æ —Å—Ç—É–ª–∞ 3√ó12", "–ü–µ—Ä–µ–Ω–æ—Å –≤–µ—Å–∞ 2√ó20", "–ë–∞–ª–∞–Ω—Å 2√ó30 —Å"]},
    {"title": "–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–º–∏–Ω–∫–∞", "steps": ["–ö—Ä—É–≥–∏ —Ç–∞–∑–æ–º 30 —Å", "–ö–æ–ª–µ–Ω–∏ –≤–≤–µ—Ä—Ö 30 —Å", "–ù–∞–∫–ª–æ–Ω—ã –≤ —Å—Ç–æ—Ä–æ–Ω—ã 20 —Ä–∞–∑"]},
    {"title": "–°–∏–ª–æ–≤–æ–π –º–∏–Ω–∏", "steps": ["–ü—Ä–∏—Å–µ–¥ 4√ó12", "–í—ã–ø–∞–¥—ã 3√ó10", "–û—Ç–∂–∏–º 3√ó8", "–ü–ª–∞–Ω–∫–∞ 3√ó30"]},
    {"title": "–¢–æ–Ω—É—Å –ø–ª–µ—á/—Å–ø–∏–Ω—ã", "steps": ["–ö—Ä—É–≥–∏ —Ä—É–∫–∞–º–∏ 30 —Å", "Y-T-W 2√ó8", "–†–∞—Å—Ç—è–∂–∫–∞ –≥—Ä—É–¥–Ω—ã—Ö 30 —Å"]},
    {"title": "–ö–∞—Ä–¥–∏–æ-—ç–Ω–µ—Ä–≥–∏—è", "steps": ["–ë—ë—Ä–ø–∏ (–ª–µ–≥–∫–æ) 3√ó10", "–°–∫–∞–∫–∞–ª–∫–∞ 2√ó60 —Å", "–ë—ã—Å—Ç—Ä–∞—è —Ö–æ–¥—å–±–∞ 5 –º–∏–Ω"]},
    {"title": "–í–µ—á–µ—Ä–Ω—è—è —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è", "steps": ["–ú–µ–¥–ª–µ–Ω–Ω—ã–µ –Ω–∞–∫–ª–æ–Ω—ã 10 —Ä–∞–∑", "–ö–æ—à–∫–∞-–∫–æ—Ä–æ–≤–∞ 8 —Ü–∏–∫–ª–æ–≤", "–®–∞–≤–∞—Å–∞–Ω–∞ 3‚Äì5 –º–∏–Ω"]},
]

# –î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ / –º–µ–¥–∏—Ç–∞—Ü–∏–∏ (20)
MEDITATIONS = [
    {"title": "4-4-4-4 (–∫–≤–∞–¥—Ä–∞—Ç)", "how": ["–í–¥–æ—Ö 4", "–ó–∞–¥–µ—Ä–∂–∫–∞ 4", "–í—ã–¥–æ—Ö 4", "–ó–∞–¥–µ—Ä–∂–∫–∞ 4", "–ü–æ–≤—Ç–æ—Ä–∏ 6-10 —Ü–∏–∫–ª–æ–≤"]},
    {"title": "4-7-8", "how": ["–í–¥–æ—Ö 4", "–ó–∞–¥–µ—Ä–∂–∫–∞ 7", "–í—ã–¥–æ—Ö 8", "3‚Äì6 —Ü–∏–∫–ª–æ–≤"]},
    {"title": "–ö–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ–µ 5/5", "how": ["–í–¥–æ—Ö 5", "–í—ã–¥–æ—Ö 5", "5‚Äì10 –º–∏–Ω—É—Ç"]},
    {"title": "–ü—Ä–æ–¥–ª—ë–Ω–Ω—ã–π –≤—ã–¥–æ—Ö 1:2", "how": ["–í–¥–æ—Ö 4", "–í—ã–¥–æ—Ö 8", "3‚Äì5 –º–∏–Ω—É—Ç"]},
    {"title": "–î–∏–∞—Ñ—Ä–∞–≥–º–∞–ª—å–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ", "how": ["–†—É–∫–∞ –Ω–∞ –∂–∏–≤–æ—Ç, –¥—ã—Ö–∞–Ω–∏–µ –Ω–æ—Å–æ–º, –∂–∏–≤–æ—Ç –ø–æ–¥ –ª–∞–¥–æ–Ω—å", "5‚Äì7 –º–∏–Ω—É—Ç"]},
    {"title": "–î—ã—Ö–∞–Ω–∏–µ –π–æ–≥–∏ (—É–¥–∂–∞–π–∏)", "how": ["–ú—è–≥–∫–∏–π —à—É–º –≤ –≥–æ—Ä–ª–µ –Ω–∞ –≤—ã–¥–æ—Ö–µ", "3‚Äì5 –º–∏–Ω—É—Ç"]},
    {"title": "–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è", "how": ["–ù–∞–ø—Ä—è–≥–∏ –∏ –æ—Ç–ø—É—Å—Ç–∏ –≥—Ä—É–ø–ø—ã –º—ã—à—Ü, —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑", "10 –º–∏–Ω—É—Ç"]},
    {"title": "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–∞", "how": ["–í–Ω–∏–º–∞–Ω–∏–µ –ø–æ –∑–æ–Ω–∞–º –æ—Ç –≥–æ–ª–æ–≤—ã –∫ —Å—Ç–æ–ø–∞–º", "5‚Äì12 –º–∏–Ω—É—Ç"]},
    {"title": "–†–∏—Ç–º —à–∞–≥–æ–≤ 4/6", "how": ["–í–æ –≤—Ä–µ–º—è –ø—Ä–æ–≥—É–ª–∫–∏: –≤–¥–æ—Ö 4 —à–∞–≥–∞, –≤—ã–¥–æ—Ö 6 —à–∞–≥–æ–≤", "10‚Äì20 –º–∏–Ω"]},
    {"title": "3 –≥–ª—É–±–æ–∫–∏—Ö –≤—ã–¥–æ—Ö–∞", "how": ["3 –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –≥–ª—É–±–æ–∫–∏—Ö –≤—ã–¥–æ—Ö–∞, —Ä–∞—Å—Å–ª–∞–±–ª—è—è –ø–ª–µ—á–∏"]},
    {"title": "–ó–∞–∑–µ–º–ª–µ–Ω–∏–µ 5-4-3-2-1", "how": ["–û—Ç–º–µ—á–∞–π –æ–±—ä–µ–∫—Ç—ã: 5 –≤–∏–∂—É, 4 —Å–ª—ã—à—É, 3 —á—É–≤—Å—Ç–≤—É—é ...", "2‚Äì3 –º–∏–Ω"]},
    {"title": "–ú–µ—Ç—Ç–∞ (–¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)", "how": ["–ü–æ—Å—ã–ª–∞–π –¥–æ–±—Ä—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è —Å–Ω–∞—á–∞–ª–∞ —Å–µ–±–µ, –ø–æ—Ç–æ–º –¥—Ä—É–≥–∏–º", "5 –º–∏–Ω"]},
    {"title": "–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥—ã—Ö–∞–Ω–∏—è", "how": ["–í–æ–æ–±—Ä–∞–∂–∞–π, –∫–∞–∫ –≤–æ–∑–¥—É—Ö —Å–º—è–≥—á–∞–µ—Ç —Ç–µ–ª–æ", "5‚Äì8 –º–∏–Ω—É—Ç"]},
    {"title": "–î—ã—Ö–∞–Ω–∏–µ ¬´–Ω–∞—Å–æ—Å¬ª", "how": ["–î–≤–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö –≤–¥–æ—Ö–∞ + –¥–ª–∏–Ω–Ω—ã–π –≤—ã–¥–æ—Ö", "1‚Äì2 –º–∏–Ω—É—Ç—ã"]},
    {"title": "–†–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–π —Å—á–µ—Ç", "how": ["–°—á–∏—Ç–∞–π —Ç–∏—Ö–æ –≤–¥–æ—Ö/–≤—ã–¥–æ—Ö –¥–æ 10, –∑–∞—Ç–µ–º –Ω–∞–∑–∞–¥", "5 –º–∏–Ω—É—Ç"]},
    {"title": "–ë–æ–¥—Ä–æ—Å—Ç—å 3/3", "how": ["–ö–æ—Ä–æ—Ç–∫–∏–π —Ä–∏—Ç–º 3/3 –ø—Ä–∏ —É—Å—Ç–∞–ª–æ—Å—Ç–∏", "2‚Äì4 –º–∏–Ω—É—Ç—ã"]},
    {"title": "–î—ã—Ö–∞–Ω–∏–µ –∂–∏–≤–æ—Ç–æ–º —Å–∏–¥—è", "how": ["–õ–∞–¥–æ–Ω—å –Ω–∞ –∂–∏–≤–æ—Ç, –¥—ã—Ö–∞–Ω–∏–µ –º—è–≥–∫–æ –≤ –∂–∏–≤–æ—Ç", "5 –º–∏–Ω—É—Ç"]},
    {"title": "–ú–∏–∫—Ä–æ-–º–µ–¥–∏—Ç–∞—Ü–∏—è 1 –º–∏–Ω", "how": ["1 –º–∏–Ω: –º–µ–¥–ª–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ —Ç–µ–ª—É"]},
    {"title": "–î–µ–Ω—å-–Ω–æ—á—å (–¥–ª—è —Å–Ω–∞)", "how": ["–í—ã–¥–æ—Ö –¥–ª–∏–Ω–Ω–µ–µ –≤–¥–æ—Ö–∞ 1.5‚Äì2√ó", "5‚Äì10 –º–∏–Ω—É—Ç –ø–µ—Ä–µ–¥ —Å–Ω–æ–º"]},
    {"title": "–î—ã—Ö–∞–Ω–∏–µ –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å", "how": ["–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ —Ç–æ—á–∫–µ —É –Ω–æ–∑–¥—Ä–µ–π", "5‚Äì10 –º–∏–Ω—É—Ç"]},
]

# –ô–æ–≥–∞ (20)
YOGA = [
    {"title": "–¢–∞–¥–∞—Å–∞–Ω–∞ (–ì–æ—Ä–∞)", "how": ["–°—Ç–æ–π –ø—Ä—è–º–æ, —Å—Ç–æ–ø—ã –≤–º–µ—Å—Ç–µ/–Ω–∞ —à–∏—Ä–∏–Ω–µ —Ç–∞–∑–∞", "–í—ã—Ç—è–Ω–∏ –º–∞–∫—É—à–∫—É –≤–≤–µ—Ä—Ö", "–î—ã—à–∏ —Ä–æ–≤–Ω–æ 6‚Äì10 —Ü–∏–∫–ª–æ–≤"]},
    {"title": "–í—Ä–∏–∫—à–∞—Å–∞–Ω–∞ (–î–µ—Ä–µ–≤–æ)", "how": ["–û–ø–æ—Ä–∞ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ", "–°—Ç–æ–ø–∞ –∫–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –±–µ–¥—Ä–µ–Ω–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏", "30‚Äì60 —Å/–Ω–æ–≥–∞"]},
    {"title": "–ê–¥—Ö–æ –ú—É–∫—Ö–∞ –®–≤–∞–Ω–∞—Å–∞–Ω–∞ (–°–æ–±–∞–∫–∞ –≤–Ω–∏–∑)", "how": ["–†–∞—Å–ø–æ–ª–æ–∂–∏ –ª–∞–¥–æ–Ω–∏, —Ç–∞–∑ –≤–≤–µ—Ä—Ö", "–î—ã—Ö–∞–Ω–∏–µ —Ä–æ–≤–Ω–æ–µ 6‚Äì8 —Ü–∏–∫–ª–æ–≤"]},
    {"title": "–ë—Ö—É–¥–∂–∞–Ω–≥–∞—Å–∞–Ω–∞ (–ö–æ–±—Ä–∞)", "how": ["–õ–µ–∂–∞, —Ä—É–∫–∏ –ø–æ–¥ –ø–ª–µ—á–∏, –º—è–≥–∫–∏–π –ø—Ä–æ–≥–∏–±", "5‚Äì8 –¥—ã—Ö–∞–Ω–∏–π"]},
    {"title": "–ë–∞–ª–∞—Å–∞–Ω–∞ (–ü–æ–∑–∞ —Ä–µ–±—ë–Ω–∫–∞)", "how": ["–°—è–¥—å –Ω–∞ –ø—è—Ç–∫–∏, –ª–æ–± –∫ –ø–æ–ª—É", "–î—ã—à–∏ —Å–ø–∏–Ω–æ–π 1‚Äì2 –º–∏–Ω—É—Ç—ã"]},
    {"title": "–í–∏—Ä–∞—Å–∞–Ω–∞ (–≤–æ–∏–Ω II)", "how": ["–®–∏—Ä–æ–∫–∞—è —Å—Ç–æ–π–∫–∞, –≤–∑–≥–ª—è–¥ –≤–ø–µ—Ä–µ–¥", "5‚Äì8 –¥—ã—Ö–∞–Ω–∏–π/—Å—Ç–æ—Ä–æ–Ω–∞"]},
    {"title": "–ü–æ–∑–∞ –¥–µ—Ä–µ–≤–∞", "how": ["–°—Ç–∞–±–∏–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å, –¥—ã—Ö–∞–Ω–∏–µ —Ä–æ–≤–Ω–æ–µ"]},
    {"title": "–ü–æ–∑–∞ –ª–æ–¥–∫–∏", "how": ["–°–∏–¥—è, –∫–æ—Ä–ø—É—Å –Ω–∞–∑–∞–¥, –¥–µ—Ä–∂–∏ —Ü–µ–Ω—Ç—Ä 20‚Äì40 —Å"]},
    {"title": "–ü–æ–∑–∞ —Å—Ç—É–ª–∞", "how": ["–ö–æ–ª–µ–Ω–∏ –Ω–∞–∑–∞–¥, —Ä—É–∫–∏ –≤–≤–µ—Ä—Ö, 5‚Äì8 –¥—ã—Ö–∞–Ω–∏–π"]},
    {"title": "–ü–æ–∑–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞", "how": ["–¢—è–Ω–µ–º—Å—è –æ–¥–Ω–æ–π —Ä—É–∫–æ–π –∫ –Ω–æ–≥–µ, —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º –≥—Ä—É–¥—å", "5 –¥—ã—Ö–∞–Ω–∏–π/—Å—Ç–æ—Ä–æ–Ω–∞"]},
    {"title": "–ü–æ–ª—É–º–æ—Å—Ç", "how": ["–õ–µ–∂–∞, –ø–æ–¥–Ω–∏–º–∞–µ–º —Ç–∞–∑, 5‚Äì8 –¥—ã—Ö–∞–Ω–∏–π"]},
    {"title": "–ü–æ–∑–∞ –º–ª–∞–¥–µ–Ω—Ü–∞ —Å—á–∞—Å—Ç—å—è", "how": ["–õ—ë–∂–∞, —Å—Ç–æ–ø—ã –≤ —Ä—É–∫–∏, –º—è–≥–∫–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞"]},
    {"title": "–ü–æ–∑–∞ –≥–æ–ª—É–±—è (–ª–∞–π—Ç)", "how": ["–ö–æ–ª–µ–Ω–æ –≤–ø–µ—Ä–µ–¥, —Ç–∞–∑ —Ä–æ–≤–Ω–æ, 1 –º–∏–Ω/—Å—Ç–æ—Ä–æ–Ω–∞"]},
    {"title": "–ö–æ—à–∫–∞-–∫–æ—Ä–æ–≤–∞", "how": ["–ù–∞ –≤–¥–æ—Ö ‚Äî –ø—Ä–æ–≥–∏–±, –Ω–∞ –≤—ã–¥–æ—Ö ‚Äî –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ", "8‚Äì12 —Ü–∏–∫–ª–æ–≤"]},
    {"title": "–®–∞–≤–∞—Å–∞–Ω–∞", "how": ["–ü–æ–ª–Ω—ã–π —Ä–µ–ª–∞–∫—Å –ª—ë–∂–∞, 3‚Äì7 –º–∏–Ω—É—Ç"]},
    {"title": "–ü–æ–∑–∞ —Å–∫—Ä—É—Ç–∫–∏ –ª—ë–∂–∞", "how": ["–ö–æ–ª–µ–Ω–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É, –ø–ª–µ—á–∏ –ø—Ä–∏–∂–∞—Ç—ã", "1‚Äì2 –º–∏–Ω—É—Ç—ã/—Å—Ç–æ—Ä–æ–Ω–∞"]},
    {"title": "–ü–æ–∑–∞ –º–æ—Å—Ç–∞ –Ω–∞ –æ–¥–Ω–æ–º –ø–ª–µ—á–µ (–ª–∞–π—Ç)", "how": ["–¢–∞–∑ –≤–≤–µ—Ä—Ö, —É–¥–µ—Ä–∂–∞–Ω–∏–µ 20‚Äì30 —Å"]},
    {"title": "–ü–ª–∞–Ω–∫–∞", "how": ["–ö–æ—Ä –≤ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏, 20‚Äì60 —Å"]},
    {"title": "–ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞ (–∫–æ–ª–µ–Ω–æ –≤ –ø–æ–ª)", "how": ["–ü–æ–¥–¥–µ—Ä–∂–∫–∞, 20‚Äì40 —Å/—Å—Ç–æ—Ä–æ–Ω–∞"]},
    {"title": "–ù–∞–∫–ª–æ–Ω —Å–∏–¥—è", "how": ["–î–ª–∏–Ω–Ω–∞—è —Å–ø–∏–Ω–∞, –Ω–∞–∫–ª–æ–Ω –æ—Ç —Ç–∞–∑–∞, 8 –¥—ã—Ö–∞–Ω–∏–π"]},
]

# –ü–∏—Ç–∞–Ω–∏–µ (50 –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–æ–≤–µ—Ç–æ–≤)
NUTRITION = [
    "–°—Ç–∞—Ä—Ç –¥–Ω—è —Å–æ —Å—Ç–∞–∫–∞–Ω–∞ –≤–æ–¥—ã (250‚Äì300 –º–ª).",
    "–î–æ–±–∞–≤–ª—è–π –±–µ–ª–æ–∫ –≤ –∫–∞–∂–¥—ã–π –ø—Ä–∏—ë–º –ø–∏—â–∏.",
    "–¶–µ–ª—å: 400 –≥ –æ–≤–æ—â–µ–π –≤ –¥–µ–Ω—å.",
    "–§—Ä—É–∫—Ç—ã 1‚Äì2 –ø–æ—Ä—Ü–∏–∏ –≤ –¥–µ–Ω—å.",
    "–¶–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤—ã–µ –≤–º–µ—Å—Ç–æ —Ä–∞—Ñ–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö.",
    "–û—Ä–µ—Ö–∏ ‚Äî –ø–æ—Ä—Ü–∏—è 20‚Äì30 –≥.",
    "–£–º–µ–Ω—å—à–∏ —Å–ª–∞–¥–∫–∏–µ –Ω–∞–ø–∏—Ç–∫–∏.",
    "–ï—à—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ ‚Äî –Ω–∞—Å—ã—â–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ–∑–∂–µ.",
    "–ó–∞–≤—Ç—Ä–∞–∫ —Å –±–µ–ª–∫–æ–º —É–ª—É—á—à–∏—Ç —Å—ã—Ç–æ—Å—Ç—å.",
    "–£–∂–∏–Ω –∑–∞ 2‚Äì3 —á–∞—Å–∞ –¥–æ —Å–Ω–∞.",
    "–ü–ª–∞–Ω–∏—Ä—É–π –º–µ–Ω—é –Ω–∞ 2‚Äì3 –¥–Ω—è.",
    "–ì–æ—Ç–æ–≤—å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª—é–¥–∞: –±–µ–ª–æ–∫ + –æ–≤–æ—â–∏.",
    "–°–æ–∫—Ä–∞—â–∞–π –ø–µ—Ä–µ–∫—É—Å—ã –∏–∑ —É–ø–∞–∫–æ–≤–∫–∏.",
    "–ü–µ–π –≤–æ–¥—É –¥–æ –µ–¥—ã ‚Äî –∏–Ω–æ–≥–¥–∞ —ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç.",
    "–°–æ–ª—å —É–º–µ—Ä–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π —Ç—Ä–∞–≤—ã –∏ —Å–ø–µ—Ü–∏–∏.",
    "–ü—Ä–æ–≤–µ—Ä—è–π –ø–æ—Ä—Ü–∏–∏ ‚Äî —Ç–∞—Ä–µ–ª–∫–∞ 1/2 –æ–≤–æ—â–∏, 1/4 –±–µ–ª–æ–∫, 1/4 —É–≥–ª–µ–≤–æ–¥—ã.",
    "–û–≥—Ä–∞–Ω–∏—á—å —Ñ–∞—Å—Ç—Ñ—É–¥, –æ–Ω –≤—ã—Å–æ–∫–æ–∫–∞–ª–æ—Ä–∏–µ–Ω –∏ –±–µ–¥–µ–Ω –Ω—É—Ç—Ä–∏–µ–Ω—Ç–∞–º–∏.",
    "–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –±–µ–ª–æ–∫ + —É–≥–ª–µ–≤–æ–¥—ã (–π–æ–≥—É—Ä—Ç + –±–∞–Ω–∞–Ω).",
    "–í–∫–ª—é—á–∞–π —Ä—ã–±—É 1‚Äì2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é.",
    "–ë–æ–±–æ–≤—ã–µ ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –±–µ–ª–∫–∞ –∏ –∫–ª–µ—Ç—á–∞—Ç–∫–∏.",
    "–ï—à—å —Å–µ–∑–æ–Ω–Ω–æ ‚Äî –≤–∫—É—Å–Ω–µ–µ –∏ —ç–∫–æ–Ω–æ–º–Ω–µ–µ.",
    "–ò–∑–±–µ–≥–∞–π –ø–æ–∑–¥–Ω–∏—Ö –ø–µ—Ä–µ–∫—É—Å–æ–≤.",
    "–°–Ω—ç–∫–∏: —Ñ—Ä—É–∫—Ç—ã, –π–æ–≥—É—Ä—Ç, –æ—Ä–µ—Ö–∏.",
    "–ß–∏—Ç–∞–π —Å–æ—Å—Ç–∞–≤—ã ‚Äî –º–µ–Ω—å—à–µ E-–∞–¥–¥–∏—Ç–∏–≤–æ–≤.",
    "–î–æ–º–∞—à–Ω–∏–µ —Å–æ—É—Å—ã –ª—É—á—à–µ –º–∞–≥–∞–∑–∏–Ω–Ω—ã—Ö.",
    "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ä—Ü–∏–π –ø–æ–º–æ–≥–∞–µ—Ç —Å–Ω–∏–∂–∞—Ç—å –≤–µ—Å.",
    "–ù–µ –ø—Ä–æ–ø—É—Å–∫–∞–π –∑–∞–≤—Ç—Ä–∞–∫ —Ä–µ–≥—É–ª—è—Ä–Ω–æ.",
    "–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ-–≥–æ–ª–æ–¥–∞–Ω–∏–µ ‚Äî –æ–ø—Ü–∏—è, –Ω–æ –Ω–µ –¥–ª—è –≤—Å–µ—Ö.",
    "–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –∫—Ä–∞–π–Ω–æ—Å—Ç–µ–π.",
    "–°–ª–∞–¥–æ—Å—Ç–∏ –ª—É—á—à–µ –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏.",
    "–ü–ª–∞–Ω–∏—Ä—É–π –ø–æ–∫—É–ø–∫–∏ —Å–ø–∏—Å–∫–æ–º.",
    "–ì–æ—Ç–æ–≤—å –∏ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–π –ø–æ—Ä—Ü–∏–∏ –¥–ª—è –∑–∞–Ω—è—Ç—ã—Ö –¥–Ω–µ–π.",
    "–ü–µ–π —á–∞–π/–≤–æ–¥—É –±–µ–∑ —Å–∞—Ö–∞—Ä–∞.",
    "–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –ø–æ–¥—Å—á—ë—Ç –∫–∞–ª–æ—Ä–∏–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.",
    "–°–ª–µ–¥–∏ –∑–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –ø–∏—â–µ–≤–æ–π –Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç–∏.",
    "–•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî –æ–∫.",
    "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ ‚Äî —Ç–∞–∫ –ª–µ–≥—á–µ —Å–æ–±–ª—é–¥–∞—Ç—å.",
    "–û—Ü–µ–Ω–∫–∞ —Å—ã—Ç–æ—Å—Ç–∏ 1‚Äì10: —Å—Ç–æ–ø –Ω–∞ 7‚Äì8.",
    "–û—Ç–¥–∞–≤–∞–π –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ —Ü–µ–ª—å–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º.",
    "–ë—ã—Å—Ç—Ä—ã–µ –ø–µ—Ä–µ–∫—É—Å—ã: —Ç–≤–æ—Ä–æ–≥, —è–π—Ü–∞, –±–∞–Ω–∞–Ω.",
    "–ì–æ—Ç–æ–≤—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–≤–æ—â–Ω—ã—Ö –≥–∞—Ä–Ω–∏—Ä–æ–≤ –∑–∞—Ä–∞–Ω–µ–µ.",
    "–î–æ–±–∞–≤–ª—è–π –∑–µ–ª–µ–Ω—å ‚Äî –≤–∏—Ç–∞–º–∏–Ω—ã –∏ –≤–∫—É—Å.",
    "–†–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–æ–Ω –ø–æ–º–æ–≥–∞–µ—Ç –ø–∏—Ç–∞–Ω–∏—é –∏ –≤–µ—Å—É.",
    "–ê–ª–∫–æ–≥–æ–ª—å –ø–æ–≤—ã—à–∞–µ—Ç –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –∏ —Å–Ω–∏–∂–∞–µ—Ç —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å.",
    "–ü–∏—Ç–∞–π—Å—è –≤ –∫–æ–º–ø–∞–Ω–∏–∏ ‚Äî —ç—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç —Å—Ç—Ä–µ—Å—Å.",
    "–ò–∑–º–µ—Ä—è–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç—Ä–µ–Ω–¥–∞–º, –∞ –Ω–µ –ø–æ –≤–µ—Å—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.",
    "–ï—Å–ª–∏ –µ—Å—Ç—å —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –±–æ–ª–µ–∑–Ω–∏ ‚Äî –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Å—è —Å –≤—Ä–∞—á–æ–º."
]

# –ê–Ω–∞–ª–∏–∑ (40 —Å–ø—Ä–∞–≤–æ–∫) ‚Äî –∫—Ä–∞—Ç–∫–∏–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—ã (–Ω–µ –º–µ–¥—Å–æ–≤–µ—Ç)
ANALYSIS = {
    "hemoglobin": "–ì–µ–º–æ–≥–ª–æ–±–∏–Ω ‚Äî –ø–µ—Ä–µ–Ω–æ—Å –∫–∏—Å–ª–æ—Ä–æ–¥–∞. –ù–∏–∑–∫–∏–π: —É—Å—Ç–∞–ª–æ—Å—Ç—å, –±–ª–µ–¥–Ω–æ—Å—Ç—å. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å —Ñ–µ—Ä—Ä–∏—Ç–∏–Ω–æ–º.",
    "ferritin": "–§–µ—Ä—Ä–∏—Ç–∏–Ω ‚Äî –∑–∞–ø–∞—Å—ã –∂–µ–ª–µ–∑–∞. –ù–∏–∑–∫–∏–π —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç —É—Å—Ç–∞–ª–æ—Å—Ç—å/–≤—ã–ø–∞–¥–µ–Ω–∏–µ –≤–æ–ª–æ—Å.",
    "vitamin_d": "–í–∏—Ç–∞–º–∏–Ω D ‚Äî –∫–æ—Å—Ç–∏ –∏ –∏–º–º—É–Ω–∏—Ç–µ—Ç. –î–µ—Ñ–∏—Ü–∏—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω, –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∞–Ω–∞–ª–∏–∑—É.",
    "b12": "B12 ‚Äî –Ω–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞. –î–µ—Ñ–∏—Ü–∏—Ç: –ø–æ–∫–∞–ª—ã–≤–∞–Ω–∏—è, —Å–ª–∞–±–æ—Å—Ç—å. –í–µ–≥–∞–Ω—ã —Ä–∏—Å–∫—É—é—Ç –±–æ–ª—å—à–µ.",
    "glucose": "–ì–ª—é–∫–æ–∑–∞ –Ω–∞—Ç–æ—â–∞–∫ ‚Äî –º–∞—Ä–∫–µ—Ä —Å–∞—Ö–∞—Ä–∞ –∫—Ä–æ–≤–∏. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è.",
    "hba1c": "HbA1c ‚Äî —Å—Ä–µ–¥–Ω—è—è –≥–ª—é–∫–æ–∑–∞ –∑–∞ 3 –º–µ—Å, –≤–∞–∂–Ω—ã–π —Å–∫—Ä–∏–Ω–∏–Ω–≥.",
    "alt": "–ê–õ–¢ ‚Äî —Ñ–µ—Ä–º–µ–Ω—Ç –ø–µ—á–µ–Ω–∏. –ü–æ–≤—ã—à–µ–Ω–∏–µ: –∞–ª–∫–æ–≥–æ–ª—å, –ª–µ–∫–∞—Ä—Å—Ç–≤–∞, –ñ–ñ–ü (–æ–∂–∏—Ä–µ–Ω–∏–µ –ø–µ—á–µ–Ω–∏).",
    "ast": "–ê–°–¢ ‚Äî —Ñ–µ—Ä–º–µ–Ω—Ç –ø–µ—á–µ–Ω–∏/–º—ã—à—Ü. –û—Ü–µ–Ω–∏–≤–∞—Ç—å –≤–º–µ—Å—Ç–µ —Å –ê–õ–¢.",
    "ggt": "–ì–ì–¢ ‚Äî —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –∞–ª–∫–æ–≥–æ–ª—é/–∂–µ–ª—á–∏.",
    "cholesterol": "–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω ‚Äî –≤–∞–∂–Ω—ã —Ñ—Ä–∞–∫—Ü–∏–∏ –õ–ü–ù–ü/–õ–ü–í–ü/–¢–ì.",
    "ldl": "–õ–ü–ù–ü ‚Äî ¬´–ø–ª–æ—Ö–æ–π¬ª —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω. –í—ã—Å–æ–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–≤—ã—à–∞—é—Ç —Ä–∏—Å–∫ –°–°–ó.",
    "hdl": "–õ–ü–í–ü ‚Äî ¬´—Ö–æ—Ä–æ—à–∏–π¬ª —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω. –ß–µ–º –≤—ã—à–µ ‚Äî –ª—É—á—à–µ.",
    "triglycerides": "–¢—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥—ã ‚Äî –ø–æ–≤—ã—à–∞—é—Ç—Å—è –ø—Ä–∏ –∏–∑–±—ã—Ç–∫–µ —Å–∞—Ö–∞—Ä–∞/–∞–ª–∫–æ–≥–æ–ª—è.",
    "creatinine": "–ö—Ä–µ–∞—Ç–∏–Ω–∏–Ω ‚Äî –ø–æ—á–∫–∏. –û—Ü–µ–Ω–∏–≤–∞—Ç—å –≤–º–µ—Å—Ç–µ —Å eGFR.",
    "egfr": "–°–ö–§ ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—á–µ–∫.",
    "uric_acid": "–ú–æ—á–µ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞ ‚Äî —Ä–∏—Å–∫ –ø–æ–¥–∞–≥—Ä—ã –ø—Ä–∏ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö.",
    "crp": "–°–†–ë ‚Äî –º–∞—Ä–∫–µ—Ä –≤–æ—Å–ø–∞–ª–µ–Ω–∏—è. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ.",
    "wbc": "–õ–µ–π–∫–æ—Ü–∏—Ç—ã ‚Äî –∏–Ω—Ñ–µ–∫—Ü–∏—è/–≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏.",
    "rbc": "–≠—Ä–∏—Ç—Ä–æ—Ü–∏—Ç—ã ‚Äî –æ—Ü–µ–Ω–∏–≤–∞—é—Ç—Å—è —Å –≥–µ–º–æ–≥–ª–æ–±–∏–Ω–æ–º –∏ Hct.",
    "platelets": "–¢—Ä–æ–º–±–æ—Ü–∏—Ç—ã ‚Äî —Å–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫—Ä–æ–≤–∏.",
    "iron": "–°—ã–≤–æ—Ä–æ—Ç–æ—á–Ω–æ–µ –∂–µ–ª–µ–∑–æ ‚Äî –ø–ª–∞–≤–∞–µ—Ç; —Å–º–æ—Ç—Ä–∏—Ç–µ —Ñ–µ—Ä—Ä–∏—Ç–∏–Ω –¥–ª—è –∑–∞–ø–∞—Å–æ–≤.",
    "tsh": "–¢–¢–ì ‚Äî —Å–∫—Ä–∏–Ω–∏–Ω–≥ —â–∏—Ç–æ–≤–∏–¥–Ω–æ–π –∂–µ–ª–µ–∑—ã.",
    "ft4": "–°–≤–æ–±–æ–¥–Ω—ã–π T4 ‚Äî —Ñ—É–Ω–∫—Ü–∏—è —â–∏—Ç–æ–≤–∏–¥–∫–∏.",
    "ft3": "–°–≤–æ–±–æ–¥–Ω—ã–π T3 ‚Äî –∞–∫—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ –≥–æ—Ä–º–æ–Ω–æ–≤.",
    "magnesium": "–ú–∞–≥–Ω–∏–π ‚Äî –º—ã—à—Ü—ã –∏ –Ω–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞. –î–µ—Ñ–∏—Ü–∏—Ç: —Å—É–¥–æ—Ä–æ–≥–∏.",
    "calcium": "–ö–∞–ª—å—Ü–∏–π ‚Äî –∫–æ—Å—Ç–∏/–Ω–µ—Ä–≤—ã. –û—Ü–µ–Ω–∏–≤–∞—Ç—å —Å PTH –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö.",
    "potassium": "–ö–∞–ª–∏–π ‚Äî —Å–µ—Ä–¥—Ü–µ. –û—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ–ø–∞—Å–Ω—ã.",
    "sodium": "–ù–∞—Ç—Ä–∏–π ‚Äî –±–∞–ª–∞–Ω—Å –∂–∏–¥–∫–æ—Å—Ç–∏.",
    "vitamin_b9": "–§–æ–ª–∞—Ç ‚Äî –≤–∞–∂–µ–Ω –ø—Ä–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∫—Ä–æ–≤–µ—Ç–≤–æ—Ä–µ–Ω–∏–∏.",
    "coag": "–ö–æ–∞–≥—É–ª–æ–≥—Ä–∞–º–º–∞ ‚Äî —Å–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫—Ä–æ–≤–∏.",
    "alp": "–©–§ ‚Äî –∂–µ–ª—á–Ω—ã–µ –ø—É—Ç–∏ –∏ –∫–æ—Å—Ç–∏.",
    "amylase": "–ê–º–∏–ª–∞–∑–∞ ‚Äî –ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.",
    "lipase": "–õ–∏–ø–∞–∑–∞ ‚Äî –ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç (–±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞).",
    "omega3": "–ò–Ω–¥–µ–∫—Å –æ–º–µ–≥–∞-3 ‚Äî –º–∞—Ä–∫–µ—Ä –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª–µ–∑–Ω—ã–º–∏ –∂–∏—Ä–∞–º–∏.",
    "insulin": "–ò–Ω—Å—É–ª–∏–Ω –Ω–∞—Ç–æ—â–∞–∫ ‚Äî –æ—Ü–µ–Ω–∫–∞ –∏–Ω—Å—É–ª–∏–Ω—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.",
    "homocysteine": "–ì–æ–º–æ—Ü–∏—Å—Ç–µ–∏–Ω ‚Äî —Å–æ—Å—É–¥–∏—Å—Ç—ã–µ —Ä–∏—Å–∫–∏ –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏.",
    "vitamin_b6": "B6 ‚Äî –º–µ—Ç–∞–±–æ–ª–∏–∑–º/–Ω–µ—Ä–≤—ã.",
    "hct": "–ì–µ–º–∞—Ç–æ–∫—Ä–∏—Ç ‚Äî % –∫—Ä–æ–≤—è–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫."
}

# ---------- –ú–ï–ù–Æ ----------
MAIN_KEYBOARD = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
MAIN_KEYBOARD.add(
    "üèãÔ∏è –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è",
    "üßò –ú–µ–¥–∏—Ç–∞—Ü–∏–∏",
    "üåÄ –ô–æ–≥–∞",
    "ü•ó –ü–∏—Ç–∞–Ω–∏–µ",
    "üìä –ê–Ω–∞–ª–∏–∑—ã",
    "üíß –í–æ–¥–∞",
    "üìà –ë–∏–æ—Ä–∏—Ç–º—ã",
    "‚ÑπÔ∏è –ü–æ–º–æ—â—å"
)

# –ü–æ–¥–º–µ–Ω—é —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–±—ã—Å—Ç—Ä–æ–µ)
DEF_COUNTS_KB = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=4)
DEF_COUNTS_KB.add("3", "5", "7", "10", "–ù–∞–∑–∞–¥")

# ---------- –•–ï–ü–õ–ï–†–´ (–∫–æ–º–∞–Ω–¥—ã) ----------
@bot.message_handler(commands=["start", "help"])
def cmd_start(message):
    text = (
        "–ü—Ä–∏–≤–µ—Ç! üëã –Ø LifeRhythm ‚Äî —Ç–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –∑–¥–æ—Ä–æ–≤—å—é.\n\n"
        "–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É —Ä–∞–∑–¥–µ–ª–∞ –∏–ª–∏ –Ω–∞–ø–∏—à–∏ –∫–æ–º–∞–Ω–¥—É:\n"
        "/exercise [N] ‚Äî —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä /exercise 5)\n"
        "/meditation [N] ‚Äî –¥—ã—Ö–∞–Ω–∏–µ –∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏\n"
        "/yoga [N] ‚Äî –ø–æ–∑—ã –π–æ–≥–∏\n"
        "/nutrition [N] ‚Äî —Å–æ–≤–µ—Ç—ã –ø–æ –ø–∏—Ç–∞–Ω–∏—é\n"
        "/analysis <–∫–ª—é—á> ‚Äî –∫—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∞–Ω–∞–ª–∏–∑—É (–Ω–∞–ø—Ä. /analysis ferritin)\n"
        "/water [–º–ª] ‚Äî –æ—Ç–º–µ—Ç–∫–∞ –≤–æ–¥—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 250)\n"
        "/stats ‚Äî —Å–∫–æ–ª—å–∫–æ –≤–æ–¥—ã —Å–µ–≥–æ–¥–Ω—è\n"
        "/setdob YYYY-MM-DD ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è\n        /biorhythm ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –±–∏–æ—Ä–∏—Ç–º—ã\n"
    )
    bot.send_message(message.chat.id, text, reply_markup=MAIN_KEYBOARD)

@bot.message_handler(commands=["exercise"])
def cmd_exercise(message):
    n = 3
    parts = message.text.split()
    if len(parts) > 1 and parts[1].isdigit():
        n = max(1, min(10, int(parts[1])))
    send_exercises(message.chat.id, n)

@bot.message_handler(commands=["meditation"])
def cmd_meditation(message):
    n = 3
    parts = message.text.split()
    if len(parts) > 1 and parts[1].isdigit():
        n = max(1, min(10, int(parts[1])))
    send_meditations(message.chat.id, n)

@bot.message_handler(commands=["yoga"])
def cmd_yoga(message):
    n = 3
    parts = message.text.split()
    if len(parts) > 1 and parts[1].isdigit():
        n = max(1, min(10, int(parts[1])))
    send_yoga(message.chat.id, n)

@bot.message_handler(commands=["nutrition"])
def cmd_nutrition(message):
    n = 10
    parts = message.text.split()
    if len(parts) > 1 and parts[1].isdigit():
        n = max(5, min(20, int(parts[1])))
    send_nutrition(message.chat.id, n)

@bot.message_handler(commands=["analysis"])
def cmd_analysis(message):
    parts = message.text.split()
    if len(parts) == 1:
        keys = ", ".join(sorted(list(ANALYSIS.keys())))
        bot.send_message(message.chat.id, "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /analysis <–∫–ª—é—á>\n–ù–∞–ø—Ä–∏–º–µ—Ä: /analysis ferritin\n\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–ª—é—á–∏: " + keys)
        return
    key = parts[1].lower()
    info = ANALYSIS.get(key)
    if not info:
        bot.send_message(message.chat.id, "–ù–µ –Ω–∞–π–¥–µ–Ω –∫–ª—é—á. –ù–∞–ø–∏—à–∏ /analysis list —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–ª—é—á–∏.")
        return
    bot.send_message(message.chat.id, f"üß™ <b>{key}</b>\n{info}\n\n<b>–í–∞–∂–Ω–æ:</b> —ç—Ç–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—ã, –Ω–µ –∑–∞–º–µ–Ω–∞ –≤—Ä–∞—á—É.", parse_mode="HTML")

@bot.message_handler(commands=["water"])
def cmd_water(message):
    args = message.text.split()
    ml = 250
    if len(args) > 1 and args[1].isdigit():
        ml = max(50, min(2000, int(args[1])))
    data = load_data()
    uid = str(message.chat.id)
    user = data["users"].setdefault(uid, {})
    water = user.setdefault("water", {})
    day = today_str()
    water[day] = water.get(day, 0) + ml
    save_data(data)
    bot.send_message(message.chat.id, f"üíß –û—Ç–º–µ—á–µ–Ω–æ +{ml} –º–ª. –í—Å–µ–≥–æ —Å–µ–≥–æ–¥–Ω—è: {water[day]} –º–ª.")

@bot.message_handler(commands=["stats"])
def cmd_stats(message):
    data = load_data()
    uid = str(message.chat.id)
    water = data["users"].get(uid, {}).get("water", {})
    total = water.get(today_str(), 0)
    bot.send_message(message.chat.id, f"üìä –í–æ–¥–∞ —Å–µ–≥–æ–¥–Ω—è: {total} –º–ª.")

@bot.message_handler(commands=["setdob"])
def cmd_setdob(message):
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /setdob YYYY-MM-DD")
        return
    val = parts[1]
    try:
        datetime.datetime.strptime(val, "%Y-%m-%d")
    except Exception:
        bot.send_message(message.chat.id, "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ü—Ä–∏–º–µ—Ä: /setdob 1990-08-20")
        return
    data = load_data()
    uid = str(message.chat.id)
    user = data["users"].setdefault(uid, {})
    user["dob"] = val
    save_data(data)
    bot.send_message(message.chat.id, f"‚úÖ –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: {val}")

@bot.message_handler(commands=["biorhythm"])
def cmd_biorhythm(message):
    data = load_data()
    uid = str(message.chat.id)
    user = data["users"].get(uid, {})
    dob = user.get("dob")
    if not dob:
        bot.send_message(message.chat.id, "–°–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è: /setdob YYYY-MM-DD")
        return
    dob_date = datetime.datetime.strptime(dob, "%Y-%m-%d").date()
    days = (datetime.date.today() - dob_date).days
    def br(days, period):
        import math
        return int(round((math.sin(2*math.pi*days/period)+1)/2*100))
    physical = br(days, 23)
    emotional = br(days, 28)
    intellectual = br(days, 33)
    txt = f"üìà –ë–∏–æ—Ä–∏—Ç–º—ã –Ω–∞ {today_str()}:\n–§–∏–∑–∏—á–µ—Å–∫–∏–π: {physical}%\n–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π: {emotional}%\n–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π: {intellectual}%\n\n–≠—Ç–æ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ ‚Äî –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Å—è –Ω–∞ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ."
    bot.send_message(message.chat.id, txt)

# ---------- –§–£–ù–ö–¶–ò–ò –û–¢–ü–†–ê–í–ö–ò (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ) ----------
def format_block(title: str, lines: List[str]) -> str:
    out = f"‚Ä¢ {title}\n"
    for i, l in enumerate(lines, 1):
        out += f"  {i}. {l}\n"
    return out

def send_exercises(chat_id: int, n: int):
    items = random.sample(EXERCISES, k=min(n, len(EXERCISES)))
    text = "üèÉ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî –≤—ã–±–µ—Ä–∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π —Ç–µ–º–ø –∏ —Å–ª—É—à–∞–π —Ç–µ–ª–æ.\n\n"
    for it in items:
        text += format_block(it["title"], it["steps"]) + "\n"
    for chunk in split_message(text):
        bot.send_message(chat_id, chunk)

def send_meditations(chat_id: int, n: int):
    items = random.sample(MEDITATIONS, k=min(n, len(MEDITATIONS)))
    text = "üßò –î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ ‚Äî –≤—ã–ø–æ–ª–Ω—è–π –≤ —Å–ø–æ–∫–æ–π–Ω–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–µ.\n\n"
    for it in items:
        text += format_block(it["title"], it["how"]) + "\n"
    for chunk in split_message(text):
        bot.send_message(chat_id, chunk)

def send_yoga(chat_id: int, n: int):
    items = random.sample(YOGA, k=min(n, len(YOGA)))
    text = "üåø –ô–æ–≥–∞ ‚Äî –∞–∫–∫—É—Ä–∞—Ç–Ω–æ, –Ω–µ —Ñ–æ—Ä—Å–∏—Ä—É–π –∞–º–ø–ª–∏—Ç—É–¥—É.\n\n"
    for it in items:
        text += format_block(it["title"], it["how"]) + "\n"
    for chunk in split_message(text):
        bot.send_message(chat_id, chunk)

def send_nutrition(chat_id: int, n: int):
    items = random.sample(NUTRITION, k=min(n, len(NUTRITION)))
    text = "ü•ó –°–æ–≤–µ—Ç—ã –ø–æ –ø–∏—Ç–∞–Ω–∏—é ‚Äî –ø—Ä–æ—Å—Ç—ã–µ –∏ —Ä–∞–±–æ—á–∏–µ.\n\n"
    for i, tip in enumerate(items, 1):
        text += f"{i}. {tip}\n"
    for chunk in split_message(text):
        bot.send_message(chat_id, chunk)

def split_message(text: str, limit: int = 3800) -> List[str]:
    if len(text) <= limit:
        return [text]
    parts = []
    while len(text) > limit:
        cut = text.rfind("\n", 0, limit)
        if cut == -1:
            cut = limit
        parts.append(text[:cut])
        text = text[cut:]
    if text:
        parts.append(text)
    return parts

# ---------- –û–ë–†–ê–ë–û–¢–ß–ò–ö –¢–ï–ö–°–¢–ê (–∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –∏ –æ—Ç–≤–µ—Ç—ã) ----------
@bot.message_handler(func=lambda m: True)
def all_text_handler(message):
    txt = message.text.strip()
    # –ë—ã—Å—Ç—Ä—ã–µ –∫–Ω–æ–ø–∫–∏: –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É —Ä–∞–∑–¥–µ–ª–∞
    if txt == "üèãÔ∏è –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è":
        # –ø—Ä–µ–¥–ª–æ–∂–∏–º –≤—ã–±—Ä–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
        kb = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=4)
        kb.add("3", "5", "7", "10", "–ù–∞–∑–∞–¥")
        bot.send_message(message.chat.id, "–°–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ–∫–∞–∑–∞—Ç—å? –ù–∞–∂–º–∏ —á–∏—Å–ª–æ –∏–ª–∏ –Ω–∞–ø–∏—à–∏ /exercise N", reply_markup=kb)
        return
    if txt == "üßò –ú–µ–¥–∏—Ç–∞—Ü–∏–∏":
        kb = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=4)
        kb.add("3", "5", "7", "10", "–ù–∞–∑–∞–¥")
        bot.send_message(message.chat.id, "–°–∫–æ–ª—å–∫–æ –ø—Ä–∞–∫—Ç–∏–∫ –ø–æ–∫–∞–∑–∞—Ç—å? –ù–∞–∂–º–∏ —á–∏—Å–ª–æ –∏–ª–∏ –Ω–∞–ø–∏—à–∏ /meditation N", reply_markup=kb)
        return
    if txt == "üåÄ –ô–æ–≥–∞":
        kb = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=4)
        kb.add("3", "5", "7", "10", "–ù–∞–∑–∞–¥")
        bot.send_message(message.chat.id, "–°–∫–æ–ª—å–∫–æ –ø–æ–∑ –ø–æ–∫–∞–∑–∞—Ç—å? –ù–∞–∂–º–∏ —á–∏—Å–ª–æ –∏–ª–∏ –Ω–∞–ø–∏—à–∏ /yoga N", reply_markup=kb)
        return
    if txt == "ü•ó –ü–∏—Ç–∞–Ω–∏–µ":
        kb = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=4)
        kb.add("5", "10", "15", "20", "–ù–∞–∑–∞–¥")
        bot.send_message(message.chat.id, "–°–∫–æ–ª—å–∫–æ —Å–æ–≤–µ—Ç–æ–≤ –ø–æ–∫–∞–∑–∞—Ç—å? –ù–∞–∂–º–∏ —á–∏—Å–ª–æ –∏–ª–∏ –Ω–∞–ø–∏—à–∏ /nutrition N", reply_markup=kb)
        return
    if txt == "üìä –ê–Ω–∞–ª–∏–∑—ã":
        bot.send_message(message.chat.id, "–ù–∞–ø–∏—à–∏ /analysis list –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–ª—é—á–µ–π –∏–ª–∏ /analysis <–∫–ª—é—á> (–Ω–∞–ø—Ä–∏–º–µ—Ä /analysis ferritin)")
        return
    if txt == "üíß –í–æ–¥–∞":
        bot.send_message(message.chat.id, "–û—Ç–º–µ—Ç—å –≤–æ–¥—É –∫–æ–º–∞–Ω–¥–æ–π /water [–º–ª], –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 250 –º–ª. –ü—Ä–∏–º–µ—Ä: /water 300")
        return
    if txt == "üìà –ë–∏–æ—Ä–∏—Ç–º—ã":
        bot.send_message(message.chat.id, "–£—Å—Ç–∞–Ω–æ–≤–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è: /setdob YYYY-MM-DD, –∑–∞—Ç–µ–º /biorhythm")
        return
    if txt == "‚ÑπÔ∏è –ü–æ–º–æ—â—å":
        cmd_start(message)
        return
    if txt == "–ù–∞–∑–∞–¥":
        bot.send_message(message.chat.id, "–í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é", reply_markup=MAIN_KEYBOARD)
        return
    # –µ—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ —Ü–∏—Ñ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞
    if txt.isdigit():
        n = int(txt)
        # –ø–æ–ø—Ä–æ–±—É–µ–º —É–≥–∞–¥–∞—Ç—å —á—Ç–æ –∑–∞–ø—Ä–æ—Å–∏–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ ‚Äî –ø—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏–ª –º–µ–¥–∏—Ç–∞—Ü–∏–∏/—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —ç—Ç–∏–º,
        # –Ω–æ —É –Ω–∞—Å –Ω–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–ø—Ä–æ—Å–∏–º, –∫–∞–∫–æ–π —Ä–∞–∑–¥–µ–ª. –£–ø—Ä–æ—Å—Ç–∏–º: –ø–æ–∫–∞–∂–µ–º –≤—Å–µ —Å–ø–∏—Å–∫–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º n ‚Äî –ø—Ä–µ–¥–ª–æ–∂–∏–º –∫–Ω–æ–ø–∫–∏
        # –†–µ–∞–ª–∏–∑—É–µ–º: —Å–ø—Ä–æ—Å–∏–º, —á—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å (–ø—Ä–µ–¥–ª–æ–∂–∏–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É)
        kb = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
        kb.add(f"–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è √ó{n}", f"–ú–µ–¥–∏—Ç–∞—Ü–∏–∏ √ó{n}")
        kb.add(f"–ô–æ–≥–∞ √ó{n}", f"–ü–∏—Ç–∞–Ω–∏–µ √ó{n}")
        kb.add("–ù–∞–∑–∞–¥")
        bot.send_message(message.chat.id, f"–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ {n} –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤?", reply_markup=kb)
        return
    # –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª "–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è √óN"
    if txt.startswith("–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è √ó"):
        try:
            n = int(txt.split("√ó")[1])
        except:
            n = 3
        send_exercises(message.chat.id, n)
        bot.send_message(message.chat.id, "–í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é", reply_markup=MAIN_KEYBOARD)
        return
    if txt.startswith("–ú–µ–¥–∏—Ç–∞—Ü–∏–∏ √ó"):
        try:
            n = int(txt.split("√ó")[1])
        except:
            n = 3
        send_meditations(message.chat.id, n)
        bot.send_message(message.chat.id, "–í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é", reply_markup=MAIN_KEYBOARD)
        return
    if txt.startswith("–ô–æ–≥–∞ √ó"):
        try:
            n = int(txt.split("√ó")[1])
        except:
            n = 3
        send_yoga(message.chat.id, n)
        bot.send_message(message.chat.id, "–í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é", reply_markup=MAIN_KEYBOARD)
        return
    if txt.startswith("–ü–∏—Ç–∞–Ω–∏–µ √ó"):
        try:
            n = int(txt.split("√ó")[1])
        except:
            n = 10
        send_nutrition(message.chat.id, n)
        bot.send_message(message.chat.id, "–í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é", reply_markup=MAIN_KEYBOARD)
        return

    # fallback: –µ—Å–ª–∏ –≤–≤–µ–¥–µ–Ω–æ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ "/exercise 7" –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤—ã—à–µ
    if txt.startswith("/exercise"):
        cmd_exercise(message); return
    if txt.startswith("/meditation"):
        cmd_meditation(message); return
    if txt.startswith("/yoga"):
        cmd_yoga(message); return
    if txt.startswith("/nutrition"):
        cmd_nutrition(message); return
    if txt.startswith("/analysis"):
        cmd_analysis(message); return
    if txt.startswith("/water"):
        cmd_water(message); return
    if txt.startswith("/setdob"):
        cmd_setdob(message); return
    if txt.startswith("/biorhythm"):
        cmd_biorhythm(message); return

    # –ï—Å–ª–∏ –Ω–µ —É–∑–Ω–∞–ª–∏ ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞
    bot.send_message(message.chat.id, "–ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª. –ò—Å–ø–æ–ª—å–∑—É–π –º–µ–Ω—é –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É /help", reply_markup=MAIN_KEYBOARD)

# ---------- FLASK WEBHOOK ----------
@app.route("/")
def index():
    return "LifeRhythm Bot ‚Äî running", 200

@app.route(WEBHOOK_PATH, methods=["POST"])
def webhook():
    data = request.get_json(force=True, silent=True)
    if not data:
        return jsonify({"ok": False, "error": "no json"}), 400
    update = telebot.types.Update.de_json(data)
    bot.process_new_updates([update])
    return jsonify({"ok": True})

# ---------- –°–¢–ê–†–¢ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º webhook –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ) ----------
def set_webhook():
    try:
        bot.remove_webhook()
    except Exception:
        pass
    res = bot.set_webhook(url=WEBHOOK_URL)
    print("Webhook set:", res, WEBHOOK_URL)

if __name__ == "__main__":
    print("Setting webhook:", WEBHOOK_URL)
    set_webhook()
    # Flask –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ‚Äî –≤ Render –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ gunicorn (Procfile –∏–ª–∏ Start Command),
    # –Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å app.run:
    app.run(host="0.0.0.0", port=PORT)
